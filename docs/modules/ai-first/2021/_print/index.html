<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.79.1"><link rel=canonical type=text/html href=/docs/modules/ai-first/2021/><link rel=alternate type=application/rss+xml href=/docs/modules/ai-first/2021/index.xml><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>2021 | Cybertraining</title><meta name=description content="by the Digital Science Center"><meta property="og:title" content="2021"><meta property="og:description" content="Here you will find a number of modules and components for introducing you to AI-First Engineering."><meta property="og:type" content="website"><meta property="og:url" content="/docs/modules/ai-first/2021/"><meta property="og:updated_time" content="2021-06-16T11:19:16-04:00"><meta property="og:site_name" content="Cybertraining"><meta itemprop=name content="2021"><meta itemprop=description content="Here you will find a number of modules and components for introducing you to AI-First Engineering."><meta name=twitter:card content="summary"><meta name=twitter:title content="2021"><meta name=twitter:description content="Here you will find a number of modules and components for introducing you to AI-First Engineering."><link rel=preload href=/scss/main.min.38f7016c100fd6fe016169222c96e00ef49b4c22d4f199ee64f2dce7c9cf0d28.css as=style><link href=/scss/main.min.38f7016c100fd6fe016169222c96e00ef49b4c22d4f199ee64f2dce7c9cf0d28.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zM197.0804 232.033c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zM197.0839 232.0372c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zM197.0839 232.0372c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zM197.0804 177.6188c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zM197.0839 177.623c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zM197.0839 177.623c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zM197.5309 286.4723c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zM197.5344 286.4765c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zM197.5344 286.4765c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zM197.0804 340.5784c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zM197.0839 340.5826c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zM197.0839 340.5826c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class="text-uppercase font-weight-bold">Cybertraining</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/about/><span>About</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/docs/><i class="fas fa-book"></i><span class=active>Content</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://github.com/google/docsy/ target=_blank><i class="fab fa-github"></i><span>GitHub</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"></div><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This the multi-page printable view of this section.
<a href=# onclick="print();return false;">Click here to print</a>.</p><p><a href=/docs/modules/ai-first/2021/>Return to the regular view of this page</a>.</p></div><h1 class=title>2021</h1><div class=lead>Here you will find a number of modules and components for introducing you to AI-First Engineering.</div><ul><li>1: <a href=#pg-f853e5d3524e9979b10bce017de31ae8>Introduction to AI-Driven Digital Transformation</a></li><li>2: <a href=#pg-e1330028af3213dade9ee84691b291a7>AI-First Engineering Cybertraining Spring 2021</a></li><li>3: <a href=#pg-756419ebe452a3971f3c4fe5e362984a>Introduction to AI in Health and Medicine</a></li><li>4: <a href=#pg-17af46460b3c7a2e517d496672f5976c>Mobility (Industry)</a></li><li>5: <a href=#pg-176391c47c2899b252156b34e3646626>Space and Energy</a></li><li>6: <a href=#pg-6f03af4f0d151f6aeb4c6426a7e84b9d>AI In Banking</a></li><li>7: <a href=#pg-0ae989d8b70c0e999b8e2ca6e18bc425>Cloud Computing</a></li><li>8: <a href=#pg-55f15a295e08c00497416f48ab4e4168>Transportation Systems</a></li><li>9: <a href=#pg-6c6881d3e740737f94bd3213994b5de3>Commerce</a></li><li>10: <a href=#pg-486e3a694cc61635a44be31e77d074a7>Python Warm Up</a></li><li>11: <a href=#pg-e145bebf0be4473adf418130cbd40023>Distributed Training for MNIST</a></li><li>12: <a href=#pg-ce8eb7227f4c10f44fdfcedff98d392a>MLP + LSTM with MNIST on Google Colab</a></li><li>13: <a href=#pg-58e48b0ff8be4361592e35752131ed18>MNIST Classification on Google Colab</a></li><li>14: <a href=#pg-0d01f29e22a0b117a134031659677469>MNIST With PyTorch</a></li><li>15: <a href=#pg-e9d8f8a00f057a21693686c040acea8b>MNIST-AutoEncoder Classification on Google Colab</a></li><li>16: <a href=#pg-777bb219db496cfedd1a8b5f23f5859f>MNIST-CNN Classification on Google Colab</a></li><li>17: <a href=#pg-cf2c391da95ceed7375b8fe8248aa3f2>MNIST-LSTM Classification on Google Colab</a></li><li>18: <a href=#pg-1ffde8dd2da86844779bae2367f007cb>MNIST-MLP Classification on Google Colab</a></li><li>19: <a href=#pg-3c61cb84662835c62f23f27cdcf1af9f>MNIST-RMM Classification on Google Colab</a></li></ul><div class=content><div class="pageinfo pageinfo-primary"><p>Big Data Applications are an important topic that have impact in
academia and industry.</p></div></div></div><div class=td-content><h1 id=pg-f853e5d3524e9979b10bce017de31ae8>1 - Introduction to AI-Driven Digital Transformation</h1><div class=lead>Last Semester&rsquo;s Introductory Lecture with introduction to and Motivation for Big Data Applications and Analytics Class. See section G for material directly related to this lass but all sections are relevant</div><div class="pageinfo pageinfo-primary"><div class=toc><nav id=TableOfContents><ul><li><a href=#a-getting-started-bdaa-course-introduction-part-a-big-data-applications-and-analytics>A: Getting Started: BDAA Course Introduction Part A: Big Data Applications and Analytics</a></li><li><a href=#b-technology-futures-from-gartners-analysis-bdaa-course-introduction-part-b-big-data-applications-and-analytics>B: Technology Futures from Gartner&rsquo;s Analysis: BDAA Course Introduction Part B: Big Data Applications and Analytics</a></li><li><a href=#c-big-data-trends-bdaa-course-introduction-part-c-big-data-applications-and-analytics>C: Big Data Trends: BDAA Course Introduction Part C: Big Data Applications and Analytics</a></li><li><a href=#d-computing-trends-bdaa-course-introduction-part-d-big-data-applications-and-analytics>D: Computing Trends: BDAA Course Introduction Part D: Big Data Applications and Analytics</a></li><li><a href=#e-big-data-and-science-bdaa-course-introduction-part-e-big-data-applications-and-analytics>E: Big Data and Science: BDAA Course Introduction Part E: Big Data Applications and Analytics</a></li><li><a href=#f-big-data-systems-bdaa-course-introduction-part-f-big-data-applications-and-analytics>F: Big Data Systems: BDAA Course Introduction Part F: Big Data Applications and Analytics</a></li><li><a href=#g-industry-transformation-bdaa-course-introduction-part-g-big-data-applications-and-analytics>G: Industry Transformation: BDAA Course Introduction Part G: Big Data Applications and Analytics</a></li><li><a href=#h-jobs-and-conclusions-bdaa-course-introduction-part-h-big-data-applications-and-analytics>H: Jobs and Conclusions: BDAA Course Introduction Part H: Big Data Applications and Analytics</a></li></ul></nav></div></div><p>This Lecture is recorded in 8 parts and gives an introduction and motivation for the class. This and other lectures in class are divided into &ldquo;bite-sized lessons&rdquo; from 5 to 30 minutes in length; that&rsquo;s why it has 8 parts.</p><p>Lecture explains what students might gain from the class even if they end up with different types of jobs from data engineering, software engineering, data science or a business (application) expert. It stresses that we are well into a transformation that impacts industry research and the way life is lived. This transformation is centered on using the digital way with clouds, edge computing and deep learning giving the implementation. This &ldquo;AI-Driven Digital Transformation&rdquo; is as transformational as the Industrial Revolution in the past. We note that deep learning dominates most innovative AI replacing several traditional machine learning methods.</p><p>The slides for this course can be found at <a href="https://docs.google.com/presentation/d/1ztKIAb6GaIcaOtiyWEHuRdR9z2xPyucgbhw-EpiDIRI/edit#slide=id.g94cec20bdc_0_240">E534-Fall2020-Introduction</a></p><h2 id=a-getting-started-bdaa-course-introduction-part-a-big-data-applications-and-analytics>A: Getting Started: BDAA Course Introduction Part A: Big Data Applications and Analytics</h2><p>This lesson describes briefly the trends driving and consequent of the AI-Driven Digital Transformation. It discusses the organizational aspects of the class and notes the two driving trends are clouds and AI. Clouds are mature and a dominant presence. AI is still rapidly changing and we can expect further major changes. The edge (devices and associated local fog computing) has always been important but now more is being done there.</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/nCbJ-2kKf0s style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=b-technology-futures-from-gartners-analysis-bdaa-course-introduction-part-b-big-data-applications-and-analytics>B: Technology Futures from Gartner&rsquo;s Analysis: BDAA Course Introduction Part B: Big Data Applications and Analytics</h2><p>This lesson goes through the technologies (AI Edge Cloud) from 2008-2020 that are driving the AI-Driven Digital Transformation. we use Hype Cycles and Priority Matrices from Gartner tracking importance concepts from the Innovation Trigger, Peak of Inflated Expectations through the Plateau of Productivity. We contrast clouds and AI.</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/QN-rPFbUAwc style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=c-big-data-trends-bdaa-course-introduction-part-c-big-data-applications-and-analytics>C: Big Data Trends: BDAA Course Introduction Part C: Big Data Applications and Analytics</h2><ul><li>This gives illustrations of sources of big data.</li><li>It gives key graphs of data sizes, images uploaded; computing, data, bandwidth trends;</li><li>Cloud-Edge architecture.</li><li>Intelligent machines and comparison of data from aircraft engine monitors compared to Twitter</li></ul><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/b_HeufZSEaE style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=d-computing-trends-bdaa-course-introduction-part-d-big-data-applications-and-analytics>D: Computing Trends: BDAA Course Introduction Part D: Big Data Applications and Analytics</h2><ul><li>Multicore revolution</li><li>Overall Global AI and Modeling Supercomputer GAIMSC</li><li>Moores Law compared to Deep Learning computing needs</li><li>Intel and NVIDIA status</li></ul><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/NxoOe5XKGyE style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=e-big-data-and-science-bdaa-course-introduction-part-e-big-data-applications-and-analytics>E: Big Data and Science: BDAA Course Introduction Part E: Big Data Applications and Analytics</h2><ul><li>Applications and Analytics</li><li>Cyberinfrastructure, e-moreorlessanything.</li><li>LHC, Higgs Boson and accelerators.</li><li>Astronomy, SKA, multi-wavelength.</li><li>Polar Grid.</li><li>Genome Sequencing.</li><li>Examples, Long Tail of Science.</li><li>Wired&rsquo;s End of Science; the 4 paradigms.</li><li>More data versus Better algorithms.</li></ul><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/C_jk161mQ_s style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=f-big-data-systems-bdaa-course-introduction-part-f-big-data-applications-and-analytics>F: Big Data Systems: BDAA Course Introduction Part F: Big Data Applications and Analytics</h2><ul><li>Clouds, Service-oriented architectures, HPC High Performance Computing, Apace Software</li><li>DIKW process illustrated by Google maps</li><li>Raw data to Information/Knowledge/Wisdom/Decision Deluge from the EdgeInformation/Knowledge/Wisdom/Decision Deluge</li><li>Parallel Computing</li><li>Map Reduce</li></ul><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/V_iqzUXCcyg style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=g-industry-transformation-bdaa-course-introduction-part-g-big-data-applications-and-analytics>G: Industry Transformation: BDAA Course Introduction Part G: Big Data Applications and Analytics</h2><p>AI grows in importance and industries transform with</p><ul><li>Core Technologies related to</li><li>New “Industries” over the last 25 years</li><li>Traditional “Industries” Transformed; malls and other old industries transform</li><li>Good to be master of Cloud Computing and Deep Learning</li><li>AI-First Industries,</li></ul><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/DAJw6mitjao style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=h-jobs-and-conclusions-bdaa-course-introduction-part-h-big-data-applications-and-analytics>H: Jobs and Conclusions: BDAA Course Introduction Part H: Big Data Applications and Analytics</h2><ul><li>Job trends</li><li>Become digitally savvy so you can take advantage of the AI/Cloud/Edge revolution with different jobs</li><li>The qualitative idea of Big Data has turned into a quantitative realization as Cloud, Edge and Deep Learning</li><li>Clouds are here to stay and one should plan on exploiting them</li><li>Data Intensive studies in business and research continue to grow in importance</li></ul><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/nsgPI45XJlw style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></div><div class=td-content style=page-break-before:always><h1 id=pg-e1330028af3213dade9ee84691b291a7>2 - AI-First Engineering Cybertraining Spring 2021</h1><div class=lead>Updated On an ongoing Basis</div><div class="pageinfo pageinfo-primary"><p>This describes weekly meeting and overall videos and homeworks</p><p>Contents</p><div class=toc><nav id=TableOfContents><ul><li><a href=#week-1>Week 1</a><ul><li><a href=#lecture>Lecture</a></li><li><a href=#assignments>Assignments</a></li></ul></li><li><a href=#week-2>Week 2</a><ul><li><a href=#introduction>Introduction</a></li><li><a href=#google-colab>Google Colab</a></li><li><a href=#first-dl-deep-learning-mnist-example-spring-2021>First DL: Deep Learning MNIST Example Spring 2021</a></li><li><a href=#introdlopt-introduction-to-deep-learning-and-optimization>IntroDLOpt: Introduction to Deep Learning and Optimization</a></li><li><a href=#opt-overview-of-optimization-spring2021>Opt: Overview of Optimization Spring2021</a></li><li><a href=#dlbasic-deep-learning---some-examples-spring-2021>DLBasic: Deep Learning - Some examples Spring 2021</a></li><li><a href=#dlbasic-components-of-deep-learning-systems>DLBasic: Components of Deep Learning Systems</a></li><li><a href=#dlbasic-summary-of-types-of-deep-learning-systems>DLBasic: Summary of Types of Deep Learning Systems</a></li></ul></li><li><a href=#week-3>Week 3</a><ul><li><a href=#deep-learning-examples-1>Deep Learning Examples, 1</a></li></ul></li><li><a href=#week-4>Week 4</a><ul><li><a href=#deep-learning-examples-2-plus-components>Deep Learning Examples, 2 plus Components</a></li></ul></li><li><a href=#week-5>Week 5</a><ul><li><a href=#deep-learning-networks-plus-overview-of-optimization>Deep Learning Networks plus Overview of Optimization</a></li></ul></li><li><a href=#week-6>Week 6</a><ul><li><a href=#deep-learning-and-ai-examples-in-health-and-medicine>Deep Learning and AI Examples in Health and Medicine</a></li></ul></li><li><a href=#week-7>Week 7</a><ul><li><a href=#deep-learning-and-ai-examples>Deep Learning and AI Examples</a></li></ul></li><li><a href=#week-8>Week 8</a><ul><li><a href=#deep-learning-and-ai-examples-1>Deep Learning and AI Examples</a></li></ul></li><li><a href=#week-9>Week 9</a><ul><li><a href=#deep-learning-and-ai-examples-2>Deep Learning and AI Examples</a></li></ul></li><li><a href=#week-10>Week 10</a><ul><li><a href=#github-for-the-class-project>GitHub for the Class project</a></li></ul></li><li><a href=#week-11>Week 11</a><ul><li><a href=#the-final-project>The Final Project</a></li></ul></li><li><a href=#week-12>Week 12</a><ul><li><a href=#practical-issues-in-deep-learning-for-earthquakes>Practical Issues in Deep Learning for Earthquakes</a></li></ul></li><li><a href=#week-13>Week 13</a><ul><li><a href=#practical-issues-in-deep-learning-for-earthquakes-1>Practical Issues in Deep Learning for Earthquakes</a></li></ul></li></ul></nav></div></div><h2 id=week-1>Week 1</h2><h3 id=lecture>Lecture</h3><p>Our first meeting is 01:10P-02:25P on Tuesday</p><p>The zoom will be <a href=https://iu.zoom.us/my/gc.fox>https://iu.zoom.us/my/gc.fox</a></p><p>We will discuss how to interact with us. We can adjust the course
somewhat.</p><p>Also as lectures are/will be put on YouTube, we will go to one lecture per week &ndash; we will choose day</p><p>The Syllabus has a general course description</p><p>Please communicate initially by email <a href=mailto:gcf@iu.edu>gcf@iu.edu</a></p><p>This first class discussed structure of class and agreed to have a section on deep learning technology.</p><p>We gave <a href="https://docs.google.com/presentation/d/1esj3zXCswQm5n8kfF-BvRH2Ih6oqNpPQjq02UPzvIB0/edit?usp=sharing">Introductory Lecture</a><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/mjWXGR9NcHU style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h3 id=assignments>Assignments</h3><ul><li>Assignment Github: Get a github.com account</li><li>Assignment Slack: Enroll in our slack at
*
<a href=https://join.slack.com/t/cybertraining-3bz7942/shared_invite/zt-kzs969ea-x35oX9wdjspX7NmkpSfUpw>https://join.slack.com/t/cybertraining-3bz7942/shared_invite/zt-kzs969ea-x35oX9wdjspX7NmkpSfUpw</a>
Post your github account name into the slack channel #general and #ai</li><li>Post a 2-3 paragraph <strong>formal</strong> Bio (see IEEE papers what a formal
bio is. Use google to find examples for Bios or look at Geoffreys or
Gregors Web Pages.)</li></ul><h2 id=week-2>Week 2</h2><h3 id=introduction>Introduction</h3><p>We gave an introductory lecture to optimization and deep learning. Unfortunately we didn&rsquo;t record the zoom serssion but we did make an offline recording with <a href="https://docs.google.com/presentation/d/1_aKqvFx0aObxpNsWA7IRPWgujMjrWBTa20dtUut6DuI/edit?usp=sharing">slides IntroDLOpt: Introduction to Deep Learning and Optimization</a> and YouTube<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/PCZZQ93xmGI style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h3 id=google-colab>Google Colab</h3><p>We also went through material on using Google Colab with examples. This is a lecture plus four Python notebooks</p><ul><li><a href="https://docs.google.com/presentation/d/1YoXPaDeHldUJM8gnbOvDsmc_U6ff5T6bYq_We1JHNMg/edit?usp=sharing">First DL: Deep Learning MNIST Example Spring 2021</a></li><li><a href=https://colab.research.google.com/notebooks/welcome.ipynb>Welcome To Colaboratory</a></li><li><a href=https://cybertraining-dsc.github.io/modules/python/google-colab/python-google-colab/>Google Colab: A gentle introduction to Google Colab for Programming</a></li><li><a href=https://cybertraining-dsc.github.io/modules/bigdataapplications/2020/python_initial/>Python Warm Up</a></li><li><a href=https://cybertraining-dsc.github.io/modules/bigdataapplications/2020/google_colab_exercise/>MNIST Classification on Google Colab</a></li></ul><p>with recorded video</p><h3 id=first-dl-deep-learning-mnist-example-spring-2021>First DL: Deep Learning MNIST Example Spring 2021</h3><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/r-aD0oHVAdA style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><p>We now have recorded all the introductory deep learning material</p><ul><li><a href="https://docs.google.com/presentation/d/1_aKqvFx0aObxpNsWA7IRPWgujMjrWBTa20dtUut6DuI/edit?usp=sharing">slides IntroDLOpt: Introduction to Deep Learning and Optimization</a></li><li><a href="https://docs.google.com/presentation/d/1NP36rgNLTP9P7NpFBRufC96tePX1-65BllVNGnXAIbY/edit?usp=sharing">slides Opt: Overview of Optimization</a></li><li><a href="https://docs.google.com/presentation/d/1Kbojr5Qd7vZ2TcxdBA7RlmwJ5kG0NEbZm-zrYad6ktc/edit?usp=sharing">slides DLBasic: Deep Learning - Some examples</a></li><li><a href="https://docs.google.com/presentation/d/1YXso4WEkp9e9Eu1LSIgpBGkEX_8ZO8R_TZaqZHc4XNU/edit?usp=sharing">slides DLBasic: Components of Deep Learning</a></li><li><a href="https://docs.google.com/presentation/d/1sjQ00oY0h6tlsYG9aN93KRjNuBHPC_7WzCmAiax2X74/edit?usp=sharing">slides DLBasic: Types of Deep Learning Networks: Summary</a></li></ul><p>with recorded videos</p><h3 id=introdlopt-introduction-to-deep-learning-and-optimization>IntroDLOpt: Introduction to Deep Learning and Optimization</h3><ul><li>Video: IntroDLOpt: Introduction to Deep Learning and Optimization<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/PCZZQ93xmGI style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></li></ul><h3 id=opt-overview-of-optimization-spring2021>Opt: Overview of Optimization Spring2021</h3><ul><li>Video: Opt: Overview of Optimization Spring2021<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/kFBqj4U9XyA style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></li></ul><h3 id=dlbasic-deep-learning---some-examples-spring-2021>DLBasic: Deep Learning - Some examples Spring 2021</h3><ul><li>Video: DLBasic: Deep Learning - Some examples Spring 2021<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/sJ-9YjgS35w style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></li></ul><h3 id=dlbasic-components-of-deep-learning-systems>DLBasic: Components of Deep Learning Systems</h3><ul><li>Video: DLBasic: Components of Deep Learning Systems<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/z9-OFr__Y-w style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></li></ul><h3 id=dlbasic-summary-of-types-of-deep-learning-systems>DLBasic: Summary of Types of Deep Learning Systems</h3><ul><li>Video: DLBasic: Summary of Types of Deep Learning Systems<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/4Ma3SFFLhYY style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></li></ul><h2 id=week-3>Week 3</h2><h3 id=deep-learning-examples-1>Deep Learning Examples, 1</h3><p>We discussed deep learning examples covering first half of slides <a href="https://docs.google.com/presentation/d/1Kbojr5Qd7vZ2TcxdBA7RlmwJ5kG0NEbZm-zrYad6ktc/edit?usp=sharing">DLBasic: Deep Learning - Some examples</a> with recorded video<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/whzCJUKJzN4 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=week-4>Week 4</h2><h3 id=deep-learning-examples-2-plus-components>Deep Learning Examples, 2 plus Components</h3><p>We concluded deep learning examples and covered components with slides <a href="https://docs.google.com/presentation/d/1njxcgyZMVS846WS4FAyYn-sb4AUT-0yylNHjYWFD0f8/edit?usp=sharing">Deep Learning: More Examples and Components</a> with recorded video<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/tfDdb8mSL98 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=week-5>Week 5</h2><h3 id=deep-learning-networks-plus-overview-of-optimization>Deep Learning Networks plus Overview of Optimization</h3><p>We covered two topics in this weeks video</p><ul><li>Deep Learning Networks with presentation <a href="https://docs.google.com/presentation/d/1sjQ00oY0h6tlsYG9aN93KRjNuBHPC_7WzCmAiax2X74/edit?usp=sharing">DLBasic: Types of Deep Learning Networks: Summary</a></li><li>General Issues in Optimization with presentation <a href="https://docs.google.com/presentation/d/1mFfF5St-DKoQyKEIaZu4tOZNO_N0h4313QlGYXbH_oE/edit?usp=sharing">Week5 Presentation on Optimization</a></li></ul><p>with recorded video<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/hGUDURDMet8 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=week-6>Week 6</h2><h3 id=deep-learning-and-ai-examples-in-health-and-medicine>Deep Learning and AI Examples in Health and Medicine</h3><p>We went about 2/3rds of way through presentation <a href="https://docs.google.com/presentation/d/1TdJ33B735nHUlKXqCdBwoyqsNIlPdmbx6wc0ExCG1d8/edit?usp=sharing">AI First Scenarios: Health and Medicine</a></p><p>with recorded video<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/Efbvy4tAcNg style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=week-7>Week 7</h2><h3 id=deep-learning-and-ai-examples>Deep Learning and AI Examples</h3><ul><li>We finished the last 1/3rd of the presentation <a href="https://docs.google.com/presentation/d/1TdJ33B735nHUlKXqCdBwoyqsNIlPdmbx6wc0ExCG1d8/edit?usp=sharing">AI First Scenarios: Health and Medicine</a></li><li>We finished <a href="https://docs.google.com/presentation/d/1ZQUV7NihZRrsMsERx4wtjIH0qt0WRqGgbNDzcZAEjRI/edit?usp=sharing">AI First Scenarios - Space</a></li><li>We started <a href="https://docs.google.com/presentation/d/1pSJs_HllfZsdk_iGKoCSUQjPceX3G1fm0oybDxw-2Zs/edit?usp=sharing">AI First Scenarios - Energy</a></li></ul><p>with recorded video<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/EG6OH1cUN8c style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=week-8>Week 8</h2><h3 id=deep-learning-and-ai-examples-1>Deep Learning and AI Examples</h3><ul><li>We finished <a href="https://docs.google.com/presentation/d/1pSJs_HllfZsdk_iGKoCSUQjPceX3G1fm0oybDxw-2Zs/edit?usp=sharing">AI First Scenarios - Energy</a></li><li>We started <a href="https://docs.google.com/presentation/d/1nK2cw542OERuHoxWGEsYH-Y1eSJMHO6yxh1tsFiUtNQ/edit?usp=sharing">AI First Scenarios: Banking and FinTech</a></li></ul><p>with recorded video<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/_mIBVwLLTmI style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=week-9>Week 9</h2><h3 id=deep-learning-and-ai-examples-2>Deep Learning and AI Examples</h3><ul><li>We ended <a href="https://docs.google.com/presentation/d/1nK2cw542OERuHoxWGEsYH-Y1eSJMHO6yxh1tsFiUtNQ/edit?usp=sharing">AI First Scenarios: Banking and FinTech</a></li><li>We started <a href="https://docs.google.com/presentation/d/1_hd1H-nQ-E4kPFE8HVLWTxoFdZJ4Db4QgKNlhSbZA5M/edit?usp=sharing">AI Scenarios in Mobility and Transportation Systems</a></li></ul><p>with recorded video<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/_TbKRO5Tw4o style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=week-10>Week 10</h2><h3 id=github-for-the-class-project>GitHub for the Class project</h3><ul><li>We explain how to use GitHub for the class project. A video is available on YouTube. Please note that we only uploaded the relevant portion. The other half of the lecture went into individual comments for each student which we have not published. The comments are included in the GitHub repository.</li></ul><p>Note project guidelines are given <a href=https://cybertraining-dsc.github.io/courses/ai-first/project-guidelines/>here</a></p><p>Video<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/PBMPWjavraU style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=week-11>Week 11</h2><h3 id=the-final-project>The Final Project</h3><ul><li>We described the gidelines of final projects in <a href="https://docs.google.com/presentation/d/1YqHJmamwPV0TNxjwn9Uh4BQcBXqKLCM0MY18raP3Zl4/edit?usp=sharing">Slides</a></li><li>We were impressed by the seven student presentations describing their chosen project and approach.</li></ul><p>Video<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/gUhZdkke9A8 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=week-12>Week 12</h2><h3 id=practical-issues-in-deep-learning-for-earthquakes>Practical Issues in Deep Learning for Earthquakes</h3><p>We used our research on Earthquake forecasting, to illustrate deep learning for Time Series with <a href="https://docs.google.com/presentation/d/1ykYnX0uvxPE-M-c-Tau8irU3IqYuvj8Ws8iUqd5RCxQ/edit?usp=sharing">slides</a></p><p>Video<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/nQBr2347Xqg style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=week-13>Week 13</h2><h3 id=practical-issues-in-deep-learning-for-earthquakes-1>Practical Issues in Deep Learning for Earthquakes</h3><p>We continued discussion that illustrated deep learning for Time Series with the same <a href="https://docs.google.com/presentation/d/1ykYnX0uvxPE-M-c-Tau8irU3IqYuvj8Ws8iUqd5RCxQ/edit?usp=sharing">slides</a> as last week</p><p>Video<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/jM2OJYDQE-Y style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p></div><div class=td-content style=page-break-before:always><h1 id=pg-756419ebe452a3971f3c4fe5e362984a>3 - Introduction to AI in Health and Medicine</h1><div class=lead>This section discusses the health and medicine sector</div><h2 id=overview>Overview</h2><p>This module discusses AI and the digital transformation for the Health and Medicine Area with a special emphasis on COVID-19 issues. We cover both the impact of COVID and some of the many activities that are addressing it. Parts B and C have an extensive general discussion of AI in Health and Medicine</p><p>The complete presentation is available at <a href="https://docs.google.com/presentation/d/1ONxy6Fu-pGZII235mfMRGAubPun5hO3bEovyETU88p8/edit?usp=sharing">Google Slides</a> while the videos are a YouTube <a href="https://www.youtube.com/playlist?list=PLy0VLh_GFyz8MoWDLMjS-v0-OWhA--lBp">playlist</a></p><h2 id=part-a-introduction>Part A: Introduction</h2><p>This lesson describes some overarching issues including the</p><ul><li>Summary in terms of Hypecycles</li><li>Players in the digital health ecosystem and in particular role of Big Tech which has needed AI expertise and infrastructure from clouds to smart watches/phones</li><li>Views of Pataients and Doctors on New Technology</li><li>Role of clouds. This is essentially assumed throughout presentation but not stressed.</li><li>Importance of Security</li><li>Introduction to Internet of Medical Things; this area is discussed in more detail later in preserntation</li></ul><p><a href="https://drive.google.com/file/d/18gsYv9yE2SPs_cuxQEInoSnLlSc_vEAZ/view?usp=sharing">slides</a></p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/08ZbpK5oe3A style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=part-b-diagnostics>Part B: Diagnostics</h2><p>This highlights some diagnostic appliocations of AI and the digital transformation. Part C also has some diagnostic coverage &ndash; especially particular applications</p><ul><li>General use of AI in Diagnostics</li><li>Early progress in diagnostic imaging including Radiology and Opthalmology</li><li>AI In Clinical Decision Support</li><li>Digital Therapeutics is a recognized and growing activity area</li></ul><p><a href="https://drive.google.com/file/d/1-n4kVEL1dkQfB7esEo6PNo6kLs64jBH1/view?usp=sharing">slides</a></p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/7-ULGwApFzM style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=part-c-examples>Part C: Examples</h2><p>This lesson covers a broad range of AI uses in Health and Medicine</p><ul><li>Flagging Issues requirng urgent attentation and more generally AI for Precision Merdicine</li><li>Oncology and cancer have made early progress as exploit AI for images. Avoiding mistakes and diagnosing curable cervical cancer in developing countries with less screening.</li><li>Predicting Gestational Diabetes</li><li>cardiovascular diagnostics and AI to interpret and guide Ultrasound measurements</li><li>Robot Nurses and robots to comfort patients</li><li>AI to guide cosmetic surgery measuring beauty</li><li>AI in analysis DNA in blood tests</li><li>AI For Stroke detection (large vessel occlusion)</li><li>AI monitoring of breathing to flag opioid-induced respiratory depression.</li><li>AI to relieve administration burden including voice to text for Doctor&rsquo;s notes</li><li>AI in consumer genomics</li><li>Areas that are slow including genomics, Consumer Robotics, Augmented/Virtual Reality and Blockchain</li><li>AI analysis of information resources flags probleme earlier</li><li>Internet of Medical Things applications from watches to toothbrushes</li></ul><p><a href="https://drive.google.com/file/d/1qqd-P0zvQY8MEZDdzuxS-DhObiMSyKRO/view?usp=sharing">slides</a></p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/Sp9h_-bf_I8 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=part-d-impact-of-covid-19>Part D: Impact of Covid-19</h2><p>This covers some aspects of the impact of COVID -19 pandedmic starting in March 2020</p><ul><li>The features of the first stimulus bill</li><li>Impact on Digital Health, Banking, Fintech, Commerce &ndash; bricks and mortar, e-commerce, groceries, credit cards, advertising, connectivity, tech industry, Ride Hailing and Delivery,</li><li>Impact on Restaurants, Airlines, Cruise lines, general travel, Food Delivery</li><li>Impact of working from home and videoconferencing</li><li>The economy and</li><li>The often positive trends for Tech industry</li></ul><p><a href="https://drive.google.com/file/d/1UjBvb6LnKZ8xzHlZhLe5TlDIme00G83v/view?usp=sharing">slides</a></p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/E6EIZr6L7x4 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=part-e-covid-19-and-recession>Part E: Covid-19 and Recession</h2><p>This is largely outdated as centered on start of pandemic induced recession. and we know what really happenmed now. Probably the pandemic accelerated the transformation of industry and the use of AI.</p><p><a href="https://drive.google.com/file/d/1sbEVK_RQdBuOmx-J8WYoYo7LhGXIp99e/view?usp=sharing">slides</a></p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/fGdyC3SVA1s style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=part-f-tackling-covid-19>Part F: Tackling Covid-19</h2><p>This discusses some of AI and digital methods used to understand and reduce impact of COVID-19</p><ul><li>Robots for remote patient examination</li><li>computerized tomography scan + AI to identify COVID-19</li><li>Early activities of Big Tech and COVID</li><li>Other early biotech activities with COVID-19</li><li>Remote-work technology: Hopin, Zoom, Run the World, FreeConferenceCall, Slack, GroWrk, Webex, Lifesize, Google Meet, Teams</li><li>Vaccines</li><li>Wearables and Monitoring, Remote patient monitoring</li><li>Telehealth, Telemedicine and Mobile Health</li></ul><p><a href="https://drive.google.com/file/d/17mYnNxsoLWJ682aDXyJ7HjR1caxYesZj/view?usp=sharing">slides</a></p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/iPDNxRS7JmI style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=part-g-data-and-computational-science-and-covid-19>Part G: Data and Computational Science and Covid-19</h2><p>This lesson reviews some sophisticated high performance computing HPC and Big Data approaches to COVID</p><ul><li>Rosetta volunteer computer to analyze proteins</li><li>COVID-19 High Performance Computing Consortium</li><li>AI based drug discovery by startup Insilico Medicine</li><li>Review of several research projects</li><li>Global Pervasive Computational Epidemiology for COVID-19 studies</li><li>Simulations of Virtual Tissues at Indiana University available on <a href=https://nanohub.org/groups/nanobio>nanoHUB</a></li></ul><p><a href="https://drive.google.com/file/d/12Mry7k1lk7f0D0VWATeyWKz82DJv0HvM/view?usp=sharing">slides</a></p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/02emPIxf_IA style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=part-h-screening-drug-and-candidates>Part H: Screening Drug and Candidates</h2><p>A major project involving Department of Energy Supercomputers</p><ul><li>General Structure of Drug Discovery</li><li>DeepDriveMD Project using AI combined with molecular dynamics to accelerate discovery of drug properties</li></ul><p><a href="https://drive.google.com/file/d/10Umb37DZrTqYSP0HigNCads60Zv3tyI1/view?usp=sharing">slides</a></p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/tbZ_ObdOoFA style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=part-i-areas-for-covid19-study-and-pandemics-as-complex-systems>Part I: Areas for Covid19 Study and Pandemics as Complex Systems</h2><p><a href="https://drive.google.com/file/d/1Nnx2GjIs1Ax7IpB1rO4nvN5XoEP0fhEu/view?usp=sharing">slides</a></p><ul><li>Possible Projects in AI for Health and Medicine and especially COVID-19</li><li>Pandemics as a Complex System</li><li>AI and computational Futures for Complex Systems</li></ul><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/F6vykp-gKoI style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></div><div class=td-content style=page-break-before:always><h1 id=pg-17af46460b3c7a2e517d496672f5976c>4 - Mobility (Industry)</h1><div class=lead>This section discusses the mobility in Industry</div><h2 id=overview>Overview</h2><ol><li>Industry being transformed by a) Autonomy (AI) and b) Electric power</li><li>Established Organizations can’t change<ul><li>General Motors (employees: 225,000 in 2016 to around 180,000 in 2018) finds it hard to compete with Tesla (42000 employees)</li><li>Market value GM was half the market value of Tesla at the start of 2020 but is now just 11% October 2020</li><li>GM purchased Cruise to compete</li><li>Funding and then buying startups is an important “transformation” strategy</li></ul></li><li>Autonomy needs Sensors Computers Algorithms and Software<ul><li>Also experience (training data)</li><li>Algorithms main bottleneck; others will automatically improve although lots of interesting work in new sensors, computers and software</li><li>Over the last 3 years, electrical power has gone from interesting to “bound to happen”; Tesla’s happy customers probably contribute to this</li><li>Batteries and Charging stations needed</li></ul></li></ol><p><a href="https://drive.google.com/file/d/1_N3JwUz4Hj7YE_rmYPZRYdJUTbs7eDdw/view?usp=sharing">Summary Slides</a></p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/1UYAq4VfpJ4 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><p><a href="https://docs.google.com/presentation/d/19yAgjNjsoSzPxEqn1Ghr9tG51EfGocuc6_JjOi_0Ijk/edit?usp=sharing">Full Slide Deck</a></p><h2 id=mobility-industry-a-introduction>Mobility Industry A: Introduction</h2><ul><li>Futures of Automobile Industry, Mobility, and Ride-Hailing</li><li>Self-cleaning cars</li><li>Medical Transportation</li><li>Society of Automotive Engineers, Levels 0-5</li><li>Gartner’s conservative View</li></ul><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/cUn4FbJdkjY style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=mobility-industry-b-self-driving-ai>Mobility Industry B: Self Driving AI</h2><ul><li>Image processing and Deep Learning</li><li>Examples of Self Driving cars</li><li>Road construction Industry</li><li>Role of Simulated data</li><li>Role of AI in autonomy</li><li>Fleet cars</li><li>3 Leaders: Waymo, Cruise, NVIDIA</li></ul><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/LgS05R23q3M style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=mobility-industry-c-general-motors-view>Mobility Industry C: General Motors View</h2><ul><li>Talk by Dave Brooks at GM, &ldquo;AI for Automotive Engineering&rdquo;</li><li>Zero crashes, zero emission, zero congestion</li><li>GM moving to electric autonomous vehicles</li></ul><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/pybTudmAod0 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=mobility-industry-d-self-driving-snippets>Mobility Industry D: Self Driving Snippets</h2><ul><li>Worries about and data on its Progress</li><li>Tesla’s specialized self-driving chip</li><li>Some tasks that are hard for AI</li><li>Scooters and Bikes</li></ul><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/-YzXTfeVZMw style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=mobility-industry-e-electrical-power>Mobility Industry E: Electrical Power</h2><ul><li>Rise in use of electrical power</li><li>Special opportunities in e-Trucks and time scale</li><li>Future of Trucks</li><li>Tesla market value</li><li>Drones and Robot deliveries; role of 5G</li><li>Robots in Logistics</li></ul><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/EwPsb_izTTo style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></div><div class=td-content style=page-break-before:always><h1 id=pg-176391c47c2899b252156b34e3646626>5 - Space and Energy</h1><div class=lead>This section discusses the space and energy.</div><h2 id=overview>Overview</h2><ol><li>Energy sources and AI for powering Grids.</li><li>Energy Solution from Bill Gates</li><li>Space and AI</li></ol><p><a href="https://docs.google.com/presentation/d/1411g_YlmX0ibGTovY8roBhqRYJgcoJ_SAb-0NQBKgMs/edit?usp=sharing">Full Slide Deck</a></p><h2 id=a-energy>A: Energy</h2><ul><li>Distributed Energy Resources as a grid of renewables with a hierarchical set of Local Distribution Areas</li><li>Electric Vehicles in Grid</li><li>Economics of microgrids</li><li>Investment into Clean Energy</li><li>Batteries</li><li>Fusion and Deep Learning for plasma stability</li><li>AI for Power Grid, Virtual Power Plant, Power Consumption Monitoring, Electricity Trading</li></ul><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/rdGWniEHpT8 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><p><a href="https://drive.google.com/file/d/1JkBbAy58e7DAmVx2jj2-WVkUnWGA72UK/view?usp=sharing">Slides</a></p><h2 id=b-clean-energy-startups-from-bill-gates>B: Clean Energy startups from Bill Gates</h2><ul><li>26 Startups in areas like long-duration storage, nuclear energy, carbon capture, batteries, fusion, and hydropower …</li><li>The slide deck gives links to 26 companies from their website and pitchbook which describes their startup status (#employees, funding)</li><li>It summarizes their products</li></ul><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/rgq99JSKoe8 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><p><a href="https://drive.google.com/file/d/18zfISCIknCKWEpVDf4qinVmrH1f6aQ6X/view?usp=sharing">Slides</a></p><h2 id=c-space>C: Space</h2><ul><li>Space supports AI with communications, image data and global navigation</li><li>AI Supports space in AI-controlled remote manufacturing, imaging control, system control, dynamic spectrum use</li><li>Privatization of Space - SpaceX, Investment</li><li>57,000 satellites through 2029</li></ul><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/bpXNLFa7piY style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><p><a href="https://drive.google.com/file/d/173WROavlVriMm3HEAY-4Ttd4cg9lR1Gu/view?usp=sharing">Slides</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-6f03af4f0d151f6aeb4c6426a7e84b9d>6 - AI In Banking</h1><div class=lead>This section discusses AI in Banking</div><h2 id=overview>Overview</h2><p>In this lecture, AI in Banking is discussed. Here we focus on the transition of legacy banks towards AI based
banking, real world examples of AI in Banking, banking systems and banking as a service.</p><p><a href="https://docs.google.com/presentation/d/10gQtuXuqAtdc4x7briVis1iQSbqu6XmZCtSlBb2np38/edit?usp=sharing">Slides</a></p><h2 id=ai-in-banking-a-the-transition-of-legacy-banks>AI in Banking A: The Transition of legacy Banks</h2><ol><li>Types of AI that is used</li><li>Closing of physical branches</li><li>Making the transition</li><li>Growth in Fintech as legacy bank services decline</li></ol><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/h5xR8uisfSc style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=ai-in-banking-b-fintech>AI in Banking B: FinTech</h2><ol><li>Fintech examples and investment</li><li>Broad areas of finance/banking where Fintech operating</li></ol><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/k0o74_e7xec style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=ai-in-banking-c-neobanks>AI in Banking C: Neobanks</h2><ol><li>Types and Examples of neobanks</li><li>Customer uptake by world region</li><li>Neobanking in Small and Medium Business segment</li><li>Neobanking in real estate, mortgages</li><li>South American Examples</li></ol><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/DMS_h_qkpDk style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=ai-in-banking-d-the-system>AI in Banking D: The System</h2><ol><li>The Front, Middle, Back Office</li><li>Front Office: Chatbots</li><li>Robo-advisors</li><li>Middle Office: Fraud, Money laundering</li><li>Fintech</li><li>Payment Gateways (Back Office)</li><li>Banking as a Service</li></ol><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/V6KuN0yZQws style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=ai-in-banking-e-examples>AI in Banking E: Examples</h2><ol><li>Credit cards</li><li>The stock trading ecosystem</li><li>Robots counting coins</li><li>AI in Insurance: Chatbots, Customer Support</li><li>Banking itself</li><li>Handwriting recognition</li><li>Detect leaks for insurance</li></ol><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/0uWDWfeLLuY style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=ai-in-banking-f-as-a-service>AI in Banking F: As a Service</h2><ol><li>Banking Services Stack</li><li>Business Model</li><li>Several Examples</li><li>Metrics compared among examples</li><li>Breadth, Depth, Reputation, Speed to Market, Scalability</li></ol><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/UYY0-OJltqQ style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></div><div class=td-content style=page-break-before:always><h1 id=pg-0ae989d8b70c0e999b8e2ca6e18bc425>7 - Cloud Computing</h1><div class=lead>Cloud Computing</div><h1 id=e534-cloud-computing-unit>E534 Cloud Computing Unit</h1><p><a href="https://docs.google.com/presentation/d/1CfdQW02IE7skOdQoJy899pozKYSx7Rcplwi9y75RwqM/edit?usp=sharing">Full Slide Deck</a></p><h2 id=overall-summary>Overall Summary</h2><p>Video:<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/FV0r-Yf6zNk style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=defining-clouds-i-basic-definition-of-cloud-and-two-very-simple-examples-of-why-virtualization-is-important>Defining Clouds I: Basic definition of cloud and two very simple examples of why virtualization is important</h2><ol><li>How clouds are situated wrt HPC and supercomputers</li><li>Why multicore chips are important</li><li>Typical data center</li></ol><p>Video:<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/8OE3oOVDmlQ style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=defining-clouds-ii-service-oriented-architectures-software-services-as-message-linked-computing-capabilities>Defining Clouds II: Service-oriented architectures: Software services as Message-linked computing capabilities</h2><ol><li>The different aaS’s: Network, Infrastructure, Platform, Software</li><li>The amazing services that Amazon AWS and Microsoft Azure have</li><li>Initial Gartner comments on clouds (they are now the norm) and evolution of servers; serverless and microservices</li><li>Gartner hypecycle and priority matrix on Infrastructure Strategies</li></ol><p>Video:<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/mzkFZApl_-4 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=defining-clouds-iii-cloud-market-share>Defining Clouds III: Cloud Market Share</h2><ol><li>How important are they?</li><li>How much money do they make?</li></ol><p>Video:<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/jYfoNxlROqU style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=virtualization-virtualization-technologies-hypervisors-and-the-different-approaches>Virtualization: Virtualization Technologies, Hypervisors and the different approaches</h2><ol><li>KVM Xen, Docker and Openstack</li></ol><p>Video:<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/Tqsx-sEPY6M style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=cloud-infrastructure-i-comments-on-trends-in-the-data-center-and-its-technologies>Cloud Infrastructure I: Comments on trends in the data center and its technologies</h2><ol><li>Clouds physically across the world</li><li>Green computing</li><li>Fraction of world’s computing ecosystem in clouds and associated sizes</li><li>An analysis from Cisco of size of cloud computing</li></ol><p>Video:<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/6ncp-UTYk-4 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=cloud-infrastructure-ii-gartner-hypecycle-and-priority-matrix-on-compute-infrastructure>Cloud Infrastructure II: Gartner hypecycle and priority matrix on Compute Infrastructure</h2><ol><li>Containers compared to virtual machines</li><li>The emergence of artificial intelligence as a dominant force</li></ol><p>Video:<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/R0Sk1rAS20M style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=cloud-software-hpc-abds-with-over-350-software-packages-and-how-to-use-each-of-21-layers>Cloud Software: HPC-ABDS with over 350 software packages and how to use each of 21 layers</h2><ol><li>Google’s software innovations</li><li>MapReduce in pictures</li><li>Cloud and HPC software stacks compared</li><li>Components need to support cloud/distributed system programming</li></ol><p>Video:<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/gMAA9y8khMM style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=cloud-applications-i-clouds-in-science-where-area-called-cyberinfrastructure-the-science-usage-pattern-from-nist>Cloud Applications I: Clouds in science where area called cyberinfrastructure; the science usage pattern from NIST</h2><ol><li>Artificial Intelligence from Gartner</li></ol><p>Video:<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/sAbYkZHD81U style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=cloud-applications-ii-characterize-applications-using-nist-approach>Cloud Applications II: Characterize Applications using NIST approach</h2><ol><li>Internet of Things</li><li>Different types of MapReduce</li></ol><p>Video:<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/YaPg-OOlkdw style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=parallel-computing-analogies-parallel-computing-in-pictures>Parallel Computing Analogies: Parallel Computing in pictures</h2><ol><li>Some useful analogies and principles</li></ol><p>Video:<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/iqVHvQg851s style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=real-parallel-computing-single-programinstruction-multiple-data-simd-spmd>Real Parallel Computing: Single Program/Instruction Multiple Data SIMD SPMD</h2><ol><li>Big Data and Simulations Compared</li><li>What is hard to do?</li></ol><p>Video:<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/7gD2yyTKatM style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=storage-cloud-data-approaches>Storage: Cloud data approaches</h2><ol><li>Repositories, File Systems, Data lakes</li></ol><p>Video:<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/NcIbKQ-AChA style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=hpc-and-clouds-the-branscomb-pyramid>HPC and Clouds: The Branscomb Pyramid</h2><ol><li>Supercomputers versus clouds</li><li>Science Computing Environments</li></ol><p>Video:<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/QTxYKhpVtDw style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=comparison-of-data-analytics-with-simulation-structure-of-different-applications-for-simulations-and-big-data>Comparison of Data Analytics with Simulation: Structure of different applications for simulations and Big Data</h2><ol><li>Software implications</li><li>Languages</li></ol><p>Video:<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/6WmWE_7iB3w style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=the-future-i-the-future-i-gartner-cloud-computing-hypecycle-and-priority-matrix-2017-and-2019>The Future I: The Future I: Gartner cloud computing hypecycle and priority matrix 2017 and 2019</h2><ol><li>Hyperscale computing</li><li>Serverless and FaaS</li><li>Cloud Native</li><li>Microservices</li><li>Update to 2019 Hypecycle</li></ol><p>Video:<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/1xH5ow5kOhc style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=future-and-other-issues-ii-security>Future and Other Issues II: Security</h2><ol><li>Blockchain</li></ol><p>Video:<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/9AmVHEXv7gY style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p><h2 id=future-and-other-issues-iii-fault-tolerance>Future and Other Issues III: Fault Tolerance</h2><p>Video:<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/VnkkCix3yEE style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p></div><div class=td-content style=page-break-before:always><h1 id=pg-55f15a295e08c00497416f48ab4e4168>8 - Transportation Systems</h1><div class=lead>This section discusses the transportation systems</div><h2 id=transportation-systems-summary>Transportation Systems Summary</h2><ol><li>The ride-hailing industry highlights the growth of a new “Transportation System” TS
a. For ride-hailing TS controls rides matching drivers and customers; it predicts how to position cars and how to avoid traffic slowdowns
b. However, TS is much bigger outside ride-hailing as we move into the “connected vehicle” era
c. TS will probably find autonomous vehicles easier to deal with than human drivers</li><li>Cloud Fog and Edge components</li><li>Autonomous AI was centered on generalized image processing</li><li>TS also needs AI (and DL) but this is for routing and geospatial time-series; different technologies from those for image processing</li></ol><p><a href="https://docs.google.com/presentation/d/19yAgjNjsoSzPxEqn1Ghr9tG51EfGocuc6_JjOi_0Ijk/edit?usp=sharing">Slides</a></p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/1UYAq4VfpJ4 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=transportation-systems-a-introduction>Transportation Systems A: Introduction</h2><ol><li>“Smart” Insurance</li><li>Fundamentals of Ride-Hailing</li></ol><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/aRBi94QTyvQ style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=transportation-systems-b-components-of-a-ride-hailing-system>Transportation Systems B: Components of a Ride-Hailing System</h2><ol><li>Transportation Brain and Services</li><li>Maps, Routing,</li><li>Traffic forecasting with deep learning</li></ol><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/obUYIj4cNao style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=transportation-systems-c-different-ai-approaches-in-ride-hailing>Transportation Systems C: Different AI Approaches in Ride-Hailing</h2><ol><li>View as a Time Series: LSTM and ARIMA</li><li>View as an image in a 2D earth surface - Convolutional networks</li><li>Use of Graph Neural Nets</li><li>Use of Convolutional Recurrent Neural Nets</li><li>Spatio-temporal modeling</li><li>Comparison of data with predictions</li><li>Reinforcement Learning</li><li>Formulation of General Geospatial Time-Series Problem</li></ol><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/k9qFE5WdQWA style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></div><div class=td-content style=page-break-before:always><h1 id=pg-6c6881d3e740737f94bd3213994b5de3>9 - Commerce</h1><div class=lead>This section discusses Commerce</div><h2 id=overview>Overview</h2><p><a href="https://docs.google.com/presentation/d/1mAcwVUutv8n8-i5Yjc0wFSlJcwDG4DWaB-wMgdmOFVs/edit?usp=sharing">Slides</a></p><h2 id=ai-in-commerce-a-the-old-way-of-doing-things>AI in Commerce A: The Old way of doing things</h2><ol><li>AI in Commerce</li><li>AI-First Engineering, Deep Learning</li><li>E-commerce and the transformation of “Bricks and Mortar”</li></ol><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/w07nShBHKRY style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=ai-in-commerce-b-ai-in-retail>AI in Commerce B: AI in Retail</h2><ol><li>Personalization</li><li>Search</li><li>Image Processing to Speed up Shopping</li><li>Walmart</li></ol><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/Kqgbbrnaf1g style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=ai-in-commerce-c-the-revolution-that-is-amazon>AI in Commerce C: The Revolution that is Amazon</h2><ol><li>Retail Revolution</li><li>Saves Time, Effort and Novelity with Modernized Retail</li><li>Looking ahead of Retail evolution</li></ol><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/M1TQp1CcjZk style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=ai-in-commerce-d-dlmalls-e-commerce>AI in Commerce D: DLMalls e-commerce</h2><ol><li>Amazon sellers</li><li>Rise of Shopify</li><li>Selling Products on Amazon</li></ol><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/kaZaxn5aHaE style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=ai-in-commerce-e-recommender-engines-digital-media>AI in Commerce E: Recommender Engines, Digital media</h2><ol><li>Spotify recommender engines</li><li>Collaborative Filtering</li><li>Audio Modelling</li><li>DNN for Recommender engines</li></ol><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/pY1KZu7EOn0 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></div><div class=td-content style=page-break-before:always><h1 id=pg-486e3a694cc61635a44be31e77d074a7>10 - Python Warm Up</h1><div class=lead>Python Exercise on Google Colab</div><h2 id=python-exercise-on-google-colab>Python Exercise on Google Colab</h2><div class=aside><table style=width:100%><tr><td><a href=https://colab.research.google.com/github/cybertraining-dsc/cybertraining-dsc.github.io/blob/master/content/en/modules/notebooks/python_warmup.ipynb target=_parent><img src=https://colab.research.google.com/assets/colab-badge.svg alt="Open In Colab"></a></td><td><a href=https://github.com/cybertraining-dsc/cybertraining-dsc.github.io/blob/master/content/en/modules/notebooks/python_warmup.ipynb target=_parent><img src=https://www.tensorflow.org/images/GitHub-Mark-32px.png alt> View in Github</a></td><td><a href=https://raw.githubusercontent.com/cybertraining-dsc/cybertraining-dsc.github.io/master/content/en/modules/notebooks/python_warmup.ipynb target=_parent><img src=https://www.tensorflow.org/images/download_logo_32px.png alt></a> Download Notebook</td></tr></table></div><p>In this exercise, we will take a look at some basic Python Concepts needed for
day-to-day coding.</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/x1ICvWDlvB0 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><p>Check the installed Python version.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#a40000>!</span> <span style=color:#000>python</span> <span style=color:#ce5c00;font-weight:700>--</span><span style=color:#000>version</span>
</code></pre></div><pre><code>Python 3.7.6
</code></pre><h2 id=simple-for-loop>Simple For Loop</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>i</span> <span style=color:#204a87;font-weight:700>in</span> <span style=color:#204a87>range</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>):</span>
  <span style=color:#204a87;font-weight:700>print</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>i</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><pre><code>0
1
2
3
4
5
6
7
8
9
</code></pre><h2 id=list>List</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>list_items</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;a&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;b&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;c&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;d&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;e&#39;</span><span style=color:#000;font-weight:700>]</span>
</code></pre></div><h3 id=retrieving-an-element>Retrieving an Element</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>list_items</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>]</span>
</code></pre></div><pre><code>'c'
</code></pre><h3 id=append-new-values>Append New Values</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>list_items</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>append</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;f&#39;</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>list_items</span>
</code></pre></div><pre><code>['a', 'b', 'c', 'd', 'e', 'f']
</code></pre><h3 id=remove-an-element>Remove an Element</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>list_items</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>remove</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;a&#39;</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>list_items</span>
</code></pre></div><pre><code>['b', 'c', 'd', 'e', 'f']
</code></pre><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/oudT4sRIuwU style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=dictionary>Dictionary</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>dictionary_items</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#39;a&#39;</span><span style=color:#000;font-weight:700>:</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;b&#39;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;c&#39;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=retrieving-an-item-by-key>Retrieving an Item by Key</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>dictionary_items</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;b&#39;</span><span style=color:#000;font-weight:700>]</span>
</code></pre></div><pre><code>2
</code></pre><h3 id=append-new-item-with-key>Append New Item with Key</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>dictionary_items</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;c&#39;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>4</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>dictionary_items</span>
</code></pre></div><pre><code>{'a': 1, 'b': 2, 'c': 4}
</code></pre><h3 id=delete-an-item-with-key>Delete an Item with Key</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#204a87;font-weight:700>del</span> <span style=color:#000>dictionary_items</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;a&#39;</span><span style=color:#000;font-weight:700>]</span> 
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>dictionary_items</span>
</code></pre></div><pre><code>{'b': 2, 'c': 4}
</code></pre><h2 id=comparators>Comparators</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>10</span>
<span style=color:#000>y</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>20</span> 
<span style=color:#000>z</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>30</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>y</span> 
</code></pre></div><pre><code>False
</code></pre><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#000>z</span>
</code></pre></div><pre><code>True
</code></pre><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>z</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>x</span>
</code></pre></div><pre><code>False
</code></pre><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#000>z</span><span style=color:#000;font-weight:700>:</span>
  <span style=color:#204a87;font-weight:700>print</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;This is True&#34;</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><pre><code>This is True
</code></pre><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>z</span><span style=color:#000;font-weight:700>:</span>
  <span style=color:#204a87;font-weight:700>print</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;This is True&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#204a87;font-weight:700>else</span><span style=color:#000;font-weight:700>:</span>
  <span style=color:#204a87;font-weight:700>print</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;This is False&#34;</span><span style=color:#000;font-weight:700>)</span>  
</code></pre></div><pre><code>This is False
</code></pre><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/GKU6-SNZGQc style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=arithmetic>Arithmetic</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>k</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>y</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>z</span>
<span style=color:#000>k</span>
</code></pre></div><pre><code>6000
</code></pre><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>j</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>y</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>z</span>
<span style=color:#000>j</span>
</code></pre></div><pre><code>60
</code></pre><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>m</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>y</span> 
<span style=color:#000>m</span>
</code></pre></div><pre><code>-10
</code></pre><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>n</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>/</span> <span style=color:#000>z</span>
<span style=color:#000>n</span>
</code></pre></div><pre><code>0.3333333333333333
</code></pre><h2 id=numpy>Numpy</h2><h3 id=create-a-random-numpy-array>Create a Random Numpy Array</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>numpy</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>np</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>a</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>random</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>rand</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>100</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>a</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>shape</span>
</code></pre></div><pre><code>(100,)
</code></pre><h3 id=reshape-numpy-array>Reshape Numpy Array</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>b</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>a</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reshape</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>b</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>shape</span>
</code></pre></div><pre><code>(10, 10)
</code></pre><h3 id=manipulate-array-elements>Manipulate Array Elements</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>c</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>b</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#0000cf;font-weight:700>10</span>
<span style=color:#000>c</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>]</span>
</code></pre></div><pre><code>array([3.33575458, 7.39029235, 5.54086921, 9.88592471, 4.9246252 ,
       1.76107178, 3.5817523 , 3.74828708, 3.57490794, 6.55752319])
</code></pre><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>c</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>mean</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>b</span><span style=color:#000;font-weight:700>,</span><span style=color:#000>axis</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>c</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>shape</span>
</code></pre></div><pre><code>10
</code></pre><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#204a87;font-weight:700>print</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>c</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><pre><code>[0.60673061 0.4223565  0.42687517 0.6260857  0.60814217 0.66445627 
  0.54888432 0.68262262 0.42523459 0.61504903]
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-e145bebf0be4473adf418130cbd40023>11 - Distributed Training for MNIST</h1><div class=lead>Distributed Training for MNIST</div><div class=aside><table style=width:100%><tr><td><a href=https://colab.research.google.com/github/cybertraining-dsc/cybertraining-dsc.github.io/blob/master/content/en/modules/notebooks/mnist_with_distributed_training.ipynb target=_parent><img src=https://colab.research.google.com/assets/colab-badge.svg alt="Open In Colab"></a></td><td><a href=https://github.com/cybertraining-dsc/cybertraining-dsc.github.io/blob/master/content/en/modules/notebooks/mnist_with_distributed_training.ipynb target=_parent><img src=https://www.tensorflow.org/images/GitHub-Mark-32px.png alt> View in Github</a></td><td><a href=https://raw.githubusercontent.com/cybertraining-dsc/cybertraining-dsc.github.io/master/content/en/modules/notebooks/mnist_with_distributed_training.ipynb download><img src=https://www.tensorflow.org/images/download_logo_32px.png alt></a> Download Notebook</td></tr></table></div><p>In this lesson we discuss in how to create a simple IPython Notebook to solve
an image classification problem with Multi Layer Perceptron with LSTM.</p><h2 id=pre-requisites>Pre-requisites</h2><p>Install the following Python packages</p><ol><li>cloudmesh-installer</li><li>cloudmesh-common</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>pip3 install cloudmesh-installer
pip3 install cloudmesh-common
</code></pre></div><h2 id=sample-mlp--lstm-with-tensorflow-keras>Sample MLP + LSTM with Tensorflow Keras</h2><h2 id=import-libraries>Import Libraries</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>__future__</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>absolute_import</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>__future__</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>division</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>__future__</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>print_function</span>

<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>numpy</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>np</span>
<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>tensorflow</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>tf</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>tensorflow.keras.models</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>Sequential</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>tensorflow.keras.layers</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>Dense</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Activation</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>SimpleRNN</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>InputLayer</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>LSTM</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Dropout</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>tensorflow.keras.utils</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>to_categorical</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>plot_model</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>tensorflow.keras.datasets</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>mnist</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>cloudmesh.common.StopWatch</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>StopWatch</span>
</code></pre></div><h2 id=download-data-and-pre-process>Download Data and Pre-Process</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>start</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;data-load&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000;font-weight:700>(</span><span style=color:#000>x_train</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_train</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_test</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>mnist</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>load_data</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>stop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;data-load&#34;</span><span style=color:#000;font-weight:700>)</span>


<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>start</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;data-pre-process&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>num_labels</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87>len</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>unique</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>y_train</span><span style=color:#000;font-weight:700>))</span>


<span style=color:#000>y_train</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>to_categorical</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>y_train</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>y_test</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>to_categorical</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>y_test</span><span style=color:#000;font-weight:700>)</span>


<span style=color:#000>image_size</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x_train</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>shape</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>]</span>
<span style=color:#000>x_train</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reshape</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_train</span><span style=color:#000;font-weight:700>,[</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#000>x_test</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reshape</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>,[</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#000>x_train</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x_train</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>astype</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;float32&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>/</span> <span style=color:#0000cf;font-weight:700>255</span>
<span style=color:#000>x_test</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x_test</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>astype</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;float32&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>/</span> <span style=color:#0000cf;font-weight:700>255</span>
<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>stop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;data-pre-process&#34;</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#000>input_shape</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>image_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>batch_size</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>128</span>
<span style=color:#000>units</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>256</span>
<span style=color:#000>dropout</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0.2</span>
</code></pre></div><h2 id=define-model>Define Model</h2><p>Here we use the Tensorflow distributed training components to train the model in multiple CPUs or GPUs.
In the Colab instance multiple GPUs are not supported.
Hence, the training must be done in the device type &lsquo;None&rsquo; when selecting the &lsquo;runtime type&rsquo; from Runtime menu.
To run with multiple-GPUs no code change is required.
<a href=https://www.tensorflow.org/guide/distributed_training>Learn more about distributed training</a>.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>start</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;compile&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>strategy</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>tf</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>distribute</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>MirroredStrategy</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#204a87;font-weight:700>with</span> <span style=color:#000>strategy</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>scope</span><span style=color:#000;font-weight:700>():</span>
  <span style=color:#000>model</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Sequential</span><span style=color:#000;font-weight:700>()</span>
  <span style=color:#8f5902;font-style:italic># LSTM Layers</span>
  <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>LSTM</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>units</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>units</span><span style=color:#000;font-weight:700>,</span>                      
                      <span style=color:#000>input_shape</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>input_shape</span><span style=color:#000;font-weight:700>,</span>
                      <span style=color:#000>return_sequences</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>True</span><span style=color:#000;font-weight:700>))</span>
  <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>LSTM</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>units</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>units</span><span style=color:#000;font-weight:700>,</span> 
                      <span style=color:#000>dropout</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>dropout</span><span style=color:#000;font-weight:700>,</span>                      
                      <span style=color:#000>return_sequences</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>True</span><span style=color:#000;font-weight:700>))</span>
  <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>LSTM</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>units</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>units</span><span style=color:#000;font-weight:700>,</span> 
                      <span style=color:#000>dropout</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>dropout</span><span style=color:#000;font-weight:700>,</span>                      
                      <span style=color:#000>return_sequences</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>False</span><span style=color:#000;font-weight:700>))</span>
  <span style=color:#8f5902;font-style:italic># MLP Layers</span>
  <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Dense</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>units</span><span style=color:#000;font-weight:700>))</span>
  <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Activation</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;relu&#39;</span><span style=color:#000;font-weight:700>))</span>
  <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Dropout</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>dropout</span><span style=color:#000;font-weight:700>))</span>
  <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Dense</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>units</span><span style=color:#000;font-weight:700>))</span>
  <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Activation</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;relu&#39;</span><span style=color:#000;font-weight:700>))</span>
  <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Dropout</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>dropout</span><span style=color:#000;font-weight:700>))</span>
  <span style=color:#8f5902;font-style:italic># Softmax_layer</span>
  <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Dense</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>num_labels</span><span style=color:#000;font-weight:700>))</span>
  <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Activation</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;softmax&#39;</span><span style=color:#000;font-weight:700>))</span>
  <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>summary</span><span style=color:#000;font-weight:700>()</span>
  <span style=color:#000>plot_model</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>to_file</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;rnn-mnist.png&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>show_shapes</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>True</span><span style=color:#000;font-weight:700>)</span>
  
  <span style=color:#204a87;font-weight:700>print</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Number of devices: {}&#34;</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>format</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>strategy</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>num_replicas_in_sync</span><span style=color:#000;font-weight:700>))</span>

  <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>compile</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>loss</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;categorical_crossentropy&#39;</span><span style=color:#000;font-weight:700>,</span>
                <span style=color:#000>optimizer</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;sgd&#39;</span><span style=color:#000;font-weight:700>,</span>
                <span style=color:#000>metrics</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;accuracy&#39;</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>stop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;compile&#34;</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>Model: <span style=color:#4e9a06>&#34;sequential_2&#34;</span>
_________________________________________________________________
Layer <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87>type</span><span style=color:#ce5c00;font-weight:700>)</span>                 Output Shape              Param <span style=color:#8f5902;font-style:italic>#   </span>
<span style=color:#ce5c00;font-weight:700>=================================================================</span>
lstm_6 <span style=color:#ce5c00;font-weight:700>(</span>LSTM<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#ce5c00;font-weight:700>(</span>None, 28, 256<span style=color:#ce5c00;font-weight:700>)</span>           <span style=color:#0000cf;font-weight:700>291840</span>    
_________________________________________________________________
lstm_7 <span style=color:#ce5c00;font-weight:700>(</span>LSTM<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#ce5c00;font-weight:700>(</span>None, 28, 256<span style=color:#ce5c00;font-weight:700>)</span>           <span style=color:#0000cf;font-weight:700>525312</span>    
_________________________________________________________________
lstm_8 <span style=color:#ce5c00;font-weight:700>(</span>LSTM<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#ce5c00;font-weight:700>(</span>None, 256<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>525312</span>    
_________________________________________________________________
dense_6 <span style=color:#ce5c00;font-weight:700>(</span>Dense<span style=color:#ce5c00;font-weight:700>)</span>              <span style=color:#ce5c00;font-weight:700>(</span>None, 256<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>65792</span>     
_________________________________________________________________
activation_6 <span style=color:#ce5c00;font-weight:700>(</span>Activation<span style=color:#ce5c00;font-weight:700>)</span>    <span style=color:#ce5c00;font-weight:700>(</span>None, 256<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
dropout_4 <span style=color:#ce5c00;font-weight:700>(</span>Dropout<span style=color:#ce5c00;font-weight:700>)</span>          <span style=color:#ce5c00;font-weight:700>(</span>None, 256<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
dense_7 <span style=color:#ce5c00;font-weight:700>(</span>Dense<span style=color:#ce5c00;font-weight:700>)</span>              <span style=color:#ce5c00;font-weight:700>(</span>None, 256<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>65792</span>     
_________________________________________________________________
activation_7 <span style=color:#ce5c00;font-weight:700>(</span>Activation<span style=color:#ce5c00;font-weight:700>)</span>    <span style=color:#ce5c00;font-weight:700>(</span>None, 256<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
dropout_5 <span style=color:#ce5c00;font-weight:700>(</span>Dropout<span style=color:#ce5c00;font-weight:700>)</span>          <span style=color:#ce5c00;font-weight:700>(</span>None, 256<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
dense_8 <span style=color:#ce5c00;font-weight:700>(</span>Dense<span style=color:#ce5c00;font-weight:700>)</span>              <span style=color:#ce5c00;font-weight:700>(</span>None, 10<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#0000cf;font-weight:700>2570</span>      
_________________________________________________________________
activation_8 <span style=color:#ce5c00;font-weight:700>(</span>Activation<span style=color:#ce5c00;font-weight:700>)</span>    <span style=color:#ce5c00;font-weight:700>(</span>None, 10<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#000>0</span>         
<span style=color:#ce5c00;font-weight:700>=================================================================</span>
Total params: 1,476,618
Trainable params: 1,476,618
Non-trainable params: <span style=color:#0000cf;font-weight:700>0</span>
_________________________________________________________________
INFO:tensorflow:Using MirroredStrategy with devices <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#39;/job:localhost/replica:0/task:0/device:GPU:0&#39;</span>,<span style=color:#ce5c00;font-weight:700>)</span>
Number of devices: <span style=color:#0000cf;font-weight:700>1</span>
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 <span style=color:#204a87;font-weight:700>then</span> broadcast to <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#39;/job:localhost/replica:0/task:0/device:CPU:0&#39;</span>,<span style=color:#ce5c00;font-weight:700>)</span>.
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 <span style=color:#204a87;font-weight:700>then</span> broadcast to <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#39;/job:localhost/replica:0/task:0/device:CPU:0&#39;</span>,<span style=color:#ce5c00;font-weight:700>)</span>.
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 <span style=color:#204a87;font-weight:700>then</span> broadcast to <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#39;/job:localhost/replica:0/task:0/device:CPU:0&#39;</span>,<span style=color:#ce5c00;font-weight:700>)</span>.
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 <span style=color:#204a87;font-weight:700>then</span> broadcast to <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#39;/job:localhost/replica:0/task:0/device:CPU:0&#39;</span>,<span style=color:#ce5c00;font-weight:700>)</span>.
</code></pre></div><h2 id=train>Train</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>start</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;train&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>fit</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_train</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_train</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>epochs</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>30</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>batch_size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>batch_size</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>stop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;train&#34;</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>Epoch 1/30
469/469 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 7s 16ms/step - loss: 2.0427 - accuracy: 0.2718
Epoch 2/30
469/469 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 7s 16ms/step - loss: 1.6934 - accuracy: 0.4007
Epoch 3/30
469/469 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 7s 16ms/step - loss: 1.2997 - accuracy: 0.5497
...
Epoch 28/30
469/469 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 8s 17ms/step - loss: 0.1175 - accuracy: 0.9640
Epoch 29/30
469/469 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 8s 17ms/step - loss: 0.1158 - accuracy: 0.9645
Epoch 30/30
469/469 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 8s 17ms/step - loss: 0.1098 - accuracy: 0.9661
</code></pre></div><h2 id=test>Test</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>start</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;evaluate&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>loss</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>acc</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>evaluate</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>batch_size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>batch_size</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#204a87;font-weight:700>print</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>Test accuracy: </span><span style=color:#4e9a06>%.1f%%</span><span style=color:#4e9a06>&#34;</span> <span style=color:#ce5c00;font-weight:700>%</span> <span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>100.0</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>acc</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>stop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;evaluate&#34;</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>benchmark</span><span style=color:#000;font-weight:700>()</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>79/79 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 3s 9ms/step - loss: 0.0898 - accuracy: 0.9719

Test accuracy: 97.2%

+---------------------+------------------------------------------------------------------+
<span style=color:#000;font-weight:700>|</span> Attribute           <span style=color:#000;font-weight:700>|</span> Value                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span>---------------------+------------------------------------------------------------------<span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> BUG_REPORT_URL      <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;https://bugs.launchpad.net/ubuntu/&#34;</span>                             <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> DISTRIB_CODENAME    <span style=color:#000;font-weight:700>|</span> bionic                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> DISTRIB_DESCRIPTION <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;Ubuntu 18.04.5 LTS&#34;</span>                                             <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> DISTRIB_ID          <span style=color:#000;font-weight:700>|</span> Ubuntu                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> DISTRIB_RELEASE     <span style=color:#000;font-weight:700>|</span> 18.04                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> HOME_URL            <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;https://www.ubuntu.com/&#34;</span>                                        <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> ID                  <span style=color:#000;font-weight:700>|</span> ubuntu                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> ID_LIKE             <span style=color:#000;font-weight:700>|</span> debian                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> NAME                <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;Ubuntu&#34;</span>                                                         <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> PRETTY_NAME         <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;Ubuntu 18.04.5 LTS&#34;</span>                                             <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> PRIVACY_POLICY_URL  <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;https://www.ubuntu.com/legal/terms-and-policies/privacy-policy&#34;</span> <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> SUPPORT_URL         <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;https://help.ubuntu.com/&#34;</span>                                       <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> UBUNTU_CODENAME     <span style=color:#000;font-weight:700>|</span> bionic                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> VERSION             <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;18.04.5 LTS (Bionic Beaver)&#34;</span>                                    <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> VERSION_CODENAME    <span style=color:#000;font-weight:700>|</span> bionic                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> VERSION_ID          <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;18.04&#34;</span>                                                          <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> cpu_count           <span style=color:#000;font-weight:700>|</span> <span style=color:#0000cf;font-weight:700>2</span>                                                                <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.active          <span style=color:#000;font-weight:700>|</span> 2.4 GiB                                                          <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.available       <span style=color:#000;font-weight:700>|</span> 10.3 GiB                                                         <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.free            <span style=color:#000;font-weight:700>|</span> 4.5 GiB                                                          <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.inactive        <span style=color:#000;font-weight:700>|</span> 5.4 GiB                                                          <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.percent         <span style=color:#000;font-weight:700>|</span> 18.6 %                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.total           <span style=color:#000;font-weight:700>|</span> 12.7 GiB                                                         <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.used            <span style=color:#000;font-weight:700>|</span> 3.3 GiB                                                          <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> platform.version    <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020                              |</span>
<span style=color:#000;font-weight:700>|</span> python              <span style=color:#000;font-weight:700>|</span> 3.7.10 <span style=color:#ce5c00;font-weight:700>(</span>default, Feb <span style=color:#0000cf;font-weight:700>20</span> 2021, 21:17:23<span style=color:#ce5c00;font-weight:700>)</span>                          <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span>                     <span style=color:#000;font-weight:700>|</span> <span style=color:#ce5c00;font-weight:700>[</span>GCC 7.5.0<span style=color:#ce5c00;font-weight:700>]</span>                                                      <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> python.pip          <span style=color:#000;font-weight:700>|</span> 19.3.1                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> python.version      <span style=color:#000;font-weight:700>|</span> 3.7.10                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> sys.platform        <span style=color:#000;font-weight:700>|</span> linux                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.machine       <span style=color:#000;font-weight:700>|</span> x86_64                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.node          <span style=color:#000;font-weight:700>|</span> b39e0899c1f8                                                     <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.processor     <span style=color:#000;font-weight:700>|</span> x86_64                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.release       <span style=color:#000;font-weight:700>|</span> 4.19.112+                                                        <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.system        <span style=color:#000;font-weight:700>|</span> Linux                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.version       <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020                              |</span>
<span style=color:#000;font-weight:700>|</span> user                <span style=color:#000;font-weight:700>|</span> collab                                                           <span style=color:#000;font-weight:700>|</span>
+---------------------+------------------------------------------------------------------+

+------------------+----------+---------+---------+---------------------+-------+--------------+--------+-------+-------------------------------------+
<span style=color:#000;font-weight:700>|</span> Name             <span style=color:#000;font-weight:700>|</span> Status   <span style=color:#000;font-weight:700>|</span>    Time <span style=color:#000;font-weight:700>|</span>     Sum <span style=color:#000;font-weight:700>|</span> Start               <span style=color:#000;font-weight:700>|</span> tag   <span style=color:#000;font-weight:700>|</span> Node         <span style=color:#000;font-weight:700>|</span> User   <span style=color:#000;font-weight:700>|</span> OS    <span style=color:#000;font-weight:700>|</span> Version                             <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span>------------------+----------+---------+---------+---------------------+-------+--------------+--------+-------+-------------------------------------<span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> data-load        <span style=color:#000;font-weight:700>|</span> failed   <span style=color:#000;font-weight:700>|</span>   0.473 <span style=color:#000;font-weight:700>|</span>   0.473 <span style=color:#000;font-weight:700>|</span> 2021-03-07 11:34:03 <span style=color:#000;font-weight:700>|</span>       <span style=color:#000;font-weight:700>|</span> b39e0899c1f8 <span style=color:#000;font-weight:700>|</span> collab <span style=color:#000;font-weight:700>|</span> Linux <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020 |</span>
<span style=color:#000;font-weight:700>|</span> data-pre-process <span style=color:#000;font-weight:700>|</span> failed   <span style=color:#000;font-weight:700>|</span>   0.073 <span style=color:#000;font-weight:700>|</span>   0.073 <span style=color:#000;font-weight:700>|</span> 2021-03-07 11:34:03 <span style=color:#000;font-weight:700>|</span>       <span style=color:#000;font-weight:700>|</span> b39e0899c1f8 <span style=color:#000;font-weight:700>|</span> collab <span style=color:#000;font-weight:700>|</span> Linux <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020 |</span>
<span style=color:#000;font-weight:700>|</span> compile          <span style=color:#000;font-weight:700>|</span> failed   <span style=color:#000;font-weight:700>|</span>   0.876 <span style=color:#000;font-weight:700>|</span>   7.187 <span style=color:#000;font-weight:700>|</span> 2021-03-07 11:38:05 <span style=color:#000;font-weight:700>|</span>       <span style=color:#000;font-weight:700>|</span> b39e0899c1f8 <span style=color:#000;font-weight:700>|</span> collab <span style=color:#000;font-weight:700>|</span> Linux <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020 |</span>
<span style=color:#000;font-weight:700>|</span> train            <span style=color:#000;font-weight:700>|</span> failed   <span style=color:#000;font-weight:700>|</span> 229.341 <span style=color:#000;font-weight:700>|</span> 257.023 <span style=color:#000;font-weight:700>|</span> 2021-03-07 11:38:44 <span style=color:#000;font-weight:700>|</span>       <span style=color:#000;font-weight:700>|</span> b39e0899c1f8 <span style=color:#000;font-weight:700>|</span> collab <span style=color:#000;font-weight:700>|</span> Linux <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020 |</span>
<span style=color:#000;font-weight:700>|</span> evaluate         <span style=color:#000;font-weight:700>|</span> failed   <span style=color:#000;font-weight:700>|</span>   2.659 <span style=color:#000;font-weight:700>|</span>   4.25  <span style=color:#000;font-weight:700>|</span> 2021-03-07 11:44:54 <span style=color:#000;font-weight:700>|</span>       <span style=color:#000;font-weight:700>|</span> b39e0899c1f8 <span style=color:#000;font-weight:700>|</span> collab <span style=color:#000;font-weight:700>|</span> Linux <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020 |</span>
+------------------+----------+---------+---------+---------------------+-------+--------------+--------+-------+-------------------------------------+

<span style=color:#8f5902;font-style:italic># csv,timer,status,time,sum,start,tag,uname.node,user,uname.system,platform.version</span>
<span style=color:#8f5902;font-style:italic># csv,data-load,failed,0.473,0.473,2021-03-07 11:34:03,,b39e0899c1f8,collab,Linux,#1 SMP Thu Jul 23 08:00:38 PDT 2020</span>
<span style=color:#8f5902;font-style:italic># csv,data-pre-process,failed,0.073,0.073,2021-03-07 11:34:03,,b39e0899c1f8,collab,Linux,#1 SMP Thu Jul 23 08:00:38 PDT 2020</span>
<span style=color:#8f5902;font-style:italic># csv,compile,failed,0.876,7.187,2021-03-07 11:38:05,,b39e0899c1f8,collab,Linux,#1 SMP Thu Jul 23 08:00:38 PDT 2020</span>
<span style=color:#8f5902;font-style:italic># csv,train,failed,229.341,257.023,2021-03-07 11:38:44,,b39e0899c1f8,collab,Linux,#1 SMP Thu Jul 23 08:00:38 PDT 2020</span>
<span style=color:#8f5902;font-style:italic># csv,evaluate,failed,2.659,4.25,2021-03-07 11:44:54,,b39e0899c1f8,collab,Linux,#1 SMP Thu Jul 23 08:00:38 PDT 2020</span>
</code></pre></div><h3 id=reference>Reference:</h3><ol><li><a href=https://github.com/PacktPublishing/Advanced-Deep-Learning-with-Keras>Advance Deep Learning with Keras</a></li><li><a href=https://www.tensorflow.org/guide/distributed_training>Distributed With Tensorflow</a></li><li><a href=https://keras.io/guides/distributed_training/>Keras with Tensorflow Distributed Training</a></li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-ce8eb7227f4c10f44fdfcedff98d392a>12 - MLP + LSTM with MNIST on Google Colab</h1><div class=lead>MLP + LSTM with MNIST on Google Colab</div><div class=aside><table style=width:100%><tr><td><a href=https://colab.research.google.com/github/cybertraining-dsc/cybertraining-dsc.github.io/blob/master/content/en/modules/notebooks/mnist_mlp_with_lstm.ipynb target=_parent><img src=https://colab.research.google.com/assets/colab-badge.svg alt="Open In Colab"></a></td><td><a href=https://github.com/cybertraining-dsc/cybertraining-dsc.github.io/blob/master/content/en/modules/notebooks/mnist_mlp_with_lstm.ipynb target=_parent><img src=https://www.tensorflow.org/images/GitHub-Mark-32px.png alt> View in Github</a></td><td><a href=https://raw.githubusercontent.com/cybertraining-dsc/cybertraining-dsc.github.io/master/content/en/modules/notebooks/mnist_mlp_with_lstm.ipynb download><img src=https://www.tensorflow.org/images/download_logo_32px.png alt></a> Download Notebook</td></tr></table></div><p>In this lesson we discuss in how to create a simple IPython Notebook to solve
an image classification problem with Multi Layer Perceptron with LSTM.</p><h2 id=pre-requisites>Pre-requisites</h2><p>Install the following Python packages</p><ol><li>cloudmesh-installer</li><li>cloudmesh-common</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>pip3 install cloudmesh-installer
pip3 install cloudmesh-common
</code></pre></div><h2 id=sample-mlp--lstm-with-tensorflow-keras>Sample MLP + LSTM with Tensorflow Keras</h2><h2 id=import-libraries>Import Libraries</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>__future__</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>absolute_import</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>__future__</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>division</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>__future__</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>print_function</span>

<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>numpy</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>np</span>
<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>tensorflow</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>tf</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>tensorflow.keras.models</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>Sequential</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>tensorflow.keras.layers</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>Dense</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Activation</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>SimpleRNN</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>InputLayer</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>LSTM</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Dropout</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>tensorflow.keras.utils</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>to_categorical</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>plot_model</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>tensorflow.keras.datasets</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>mnist</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>cloudmesh.common.StopWatch</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>StopWatch</span>
</code></pre></div><h2 id=download-data-and-pre-process>Download Data and Pre-Process</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>start</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;data-load&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000;font-weight:700>(</span><span style=color:#000>x_train</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_train</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_test</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>mnist</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>load_data</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>stop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;data-load&#34;</span><span style=color:#000;font-weight:700>)</span>


<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>start</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;data-pre-process&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>num_labels</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87>len</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>unique</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>y_train</span><span style=color:#000;font-weight:700>))</span>


<span style=color:#000>y_train</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>to_categorical</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>y_train</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>y_test</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>to_categorical</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>y_test</span><span style=color:#000;font-weight:700>)</span>


<span style=color:#000>image_size</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x_train</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>shape</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>]</span>
<span style=color:#000>x_train</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reshape</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_train</span><span style=color:#000;font-weight:700>,[</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#000>x_test</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reshape</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>,[</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#000>x_train</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x_train</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>astype</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;float32&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>/</span> <span style=color:#0000cf;font-weight:700>255</span>
<span style=color:#000>x_test</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x_test</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>astype</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;float32&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>/</span> <span style=color:#0000cf;font-weight:700>255</span>
<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>stop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;data-pre-process&#34;</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#000>input_shape</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>image_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>batch_size</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>128</span>
<span style=color:#000>units</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>256</span>
<span style=color:#000>dropout</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0.2</span>
</code></pre></div><h2 id=define-model>Define Model</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>start</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;compile&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>model</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Sequential</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#8f5902;font-style:italic># LSTM Layers</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>LSTM</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>units</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>units</span><span style=color:#000;font-weight:700>,</span>                      
                     <span style=color:#000>input_shape</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>input_shape</span><span style=color:#000;font-weight:700>,</span>
                     <span style=color:#000>return_sequences</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>True</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>LSTM</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>units</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>units</span><span style=color:#000;font-weight:700>,</span> 
                     <span style=color:#000>dropout</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>dropout</span><span style=color:#000;font-weight:700>,</span>                      
                     <span style=color:#000>return_sequences</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>True</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>LSTM</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>units</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>units</span><span style=color:#000;font-weight:700>,</span> 
                     <span style=color:#000>dropout</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>dropout</span><span style=color:#000;font-weight:700>,</span>                      
                     <span style=color:#000>return_sequences</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>False</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#8f5902;font-style:italic># MLP Layers</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Dense</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>units</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Activation</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;relu&#39;</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Dropout</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>dropout</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Dense</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>units</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Activation</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;relu&#39;</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Dropout</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>dropout</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#8f5902;font-style:italic># Softmax_layer</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Dense</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>num_labels</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Activation</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;softmax&#39;</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>summary</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>plot_model</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>to_file</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;rnn-mnist.png&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>show_shapes</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>True</span><span style=color:#000;font-weight:700>)</span>


<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>compile</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>loss</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;categorical_crossentropy&#39;</span><span style=color:#000;font-weight:700>,</span>
              <span style=color:#000>optimizer</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;sgd&#39;</span><span style=color:#000;font-weight:700>,</span>
              <span style=color:#000>metrics</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;accuracy&#39;</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>stop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;compile&#34;</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>Model: <span style=color:#4e9a06>&#34;sequential&#34;</span>
_________________________________________________________________
Layer <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87>type</span><span style=color:#ce5c00;font-weight:700>)</span>                 Output Shape              Param <span style=color:#8f5902;font-style:italic>#   </span>
<span style=color:#ce5c00;font-weight:700>=================================================================</span>
lstm <span style=color:#ce5c00;font-weight:700>(</span>LSTM<span style=color:#ce5c00;font-weight:700>)</span>                  <span style=color:#ce5c00;font-weight:700>(</span>None, 28, 256<span style=color:#ce5c00;font-weight:700>)</span>           <span style=color:#0000cf;font-weight:700>291840</span>    
_________________________________________________________________
lstm_1 <span style=color:#ce5c00;font-weight:700>(</span>LSTM<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#ce5c00;font-weight:700>(</span>None, 28, 256<span style=color:#ce5c00;font-weight:700>)</span>           <span style=color:#0000cf;font-weight:700>525312</span>    
_________________________________________________________________
lstm_2 <span style=color:#ce5c00;font-weight:700>(</span>LSTM<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#ce5c00;font-weight:700>(</span>None, 256<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>525312</span>    
_________________________________________________________________
dense <span style=color:#ce5c00;font-weight:700>(</span>Dense<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#ce5c00;font-weight:700>(</span>None, 256<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>65792</span>     
_________________________________________________________________
activation <span style=color:#ce5c00;font-weight:700>(</span>Activation<span style=color:#ce5c00;font-weight:700>)</span>      <span style=color:#ce5c00;font-weight:700>(</span>None, 256<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
dropout <span style=color:#ce5c00;font-weight:700>(</span>Dropout<span style=color:#ce5c00;font-weight:700>)</span>            <span style=color:#ce5c00;font-weight:700>(</span>None, 256<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
dense_1 <span style=color:#ce5c00;font-weight:700>(</span>Dense<span style=color:#ce5c00;font-weight:700>)</span>              <span style=color:#ce5c00;font-weight:700>(</span>None, 256<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>65792</span>     
_________________________________________________________________
activation_1 <span style=color:#ce5c00;font-weight:700>(</span>Activation<span style=color:#ce5c00;font-weight:700>)</span>    <span style=color:#ce5c00;font-weight:700>(</span>None, 256<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
dropout_1 <span style=color:#ce5c00;font-weight:700>(</span>Dropout<span style=color:#ce5c00;font-weight:700>)</span>          <span style=color:#ce5c00;font-weight:700>(</span>None, 256<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
dense_2 <span style=color:#ce5c00;font-weight:700>(</span>Dense<span style=color:#ce5c00;font-weight:700>)</span>              <span style=color:#ce5c00;font-weight:700>(</span>None, 10<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#0000cf;font-weight:700>2570</span>      
_________________________________________________________________
activation_2 <span style=color:#ce5c00;font-weight:700>(</span>Activation<span style=color:#ce5c00;font-weight:700>)</span>    <span style=color:#ce5c00;font-weight:700>(</span>None, 10<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#000>0</span>         
<span style=color:#ce5c00;font-weight:700>=================================================================</span>
Total params: 1,476,618
Trainable params: 1,476,618
Non-trainable params: <span style=color:#0000cf;font-weight:700>0</span>
</code></pre></div><h2 id=train>Train</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>start</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;train&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>fit</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_train</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_train</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>epochs</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>30</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>batch_size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>batch_size</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>stop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;train&#34;</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>469/469 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 378s 796ms/step - loss: 2.2689 - accuracy: 0.2075
</code></pre></div><h2 id=test>Test</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>start</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;evaluate&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>loss</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>acc</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>evaluate</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>batch_size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>batch_size</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#204a87;font-weight:700>print</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>Test accuracy: </span><span style=color:#4e9a06>%.1f%%</span><span style=color:#4e9a06>&#34;</span> <span style=color:#ce5c00;font-weight:700>%</span> <span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>100.0</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>acc</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>stop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;evaluate&#34;</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>benchmark</span><span style=color:#000;font-weight:700>()</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>79/79 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 1s 7ms/step - loss: 2.2275 - accuracy: 0.3120

Test accuracy: 31.2%

+---------------------+------------------------------------------------------------------+
<span style=color:#000;font-weight:700>|</span> Attribute           <span style=color:#000;font-weight:700>|</span> Value                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span>---------------------+------------------------------------------------------------------<span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> BUG_REPORT_URL      <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;https://bugs.launchpad.net/ubuntu/&#34;</span>                             <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> DISTRIB_CODENAME    <span style=color:#000;font-weight:700>|</span> bionic                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> DISTRIB_DESCRIPTION <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;Ubuntu 18.04.5 LTS&#34;</span>                                             <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> DISTRIB_ID          <span style=color:#000;font-weight:700>|</span> Ubuntu                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> DISTRIB_RELEASE     <span style=color:#000;font-weight:700>|</span> 18.04                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> HOME_URL            <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;https://www.ubuntu.com/&#34;</span>                                        <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> ID                  <span style=color:#000;font-weight:700>|</span> ubuntu                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> ID_LIKE             <span style=color:#000;font-weight:700>|</span> debian                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> NAME                <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;Ubuntu&#34;</span>                                                         <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> PRETTY_NAME         <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;Ubuntu 18.04.5 LTS&#34;</span>                                             <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> PRIVACY_POLICY_URL  <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;https://www.ubuntu.com/legal/terms-and-policies/privacy-policy&#34;</span> <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> SUPPORT_URL         <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;https://help.ubuntu.com/&#34;</span>                                       <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> UBUNTU_CODENAME     <span style=color:#000;font-weight:700>|</span> bionic                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> VERSION             <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;18.04.5 LTS (Bionic Beaver)&#34;</span>                                    <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> VERSION_CODENAME    <span style=color:#000;font-weight:700>|</span> bionic                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> VERSION_ID          <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;18.04&#34;</span>                                                          <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> cpu_count           <span style=color:#000;font-weight:700>|</span> <span style=color:#0000cf;font-weight:700>2</span>                                                                <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.active          <span style=color:#000;font-weight:700>|</span> 1.9 GiB                                                          <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.available       <span style=color:#000;font-weight:700>|</span> 10.7 GiB                                                         <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.free            <span style=color:#000;font-weight:700>|</span> 7.3 GiB                                                          <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.inactive        <span style=color:#000;font-weight:700>|</span> 3.0 GiB                                                          <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.percent         <span style=color:#000;font-weight:700>|</span> 15.6 %                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.total           <span style=color:#000;font-weight:700>|</span> 12.7 GiB                                                         <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.used            <span style=color:#000;font-weight:700>|</span> 2.3 GiB                                                          <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> platform.version    <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020                              |</span>
<span style=color:#000;font-weight:700>|</span> python              <span style=color:#000;font-weight:700>|</span> 3.6.9 <span style=color:#ce5c00;font-weight:700>(</span>default, Oct  <span style=color:#0000cf;font-weight:700>8</span> 2020, 12:12:24<span style=color:#ce5c00;font-weight:700>)</span>                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span>                     <span style=color:#000;font-weight:700>|</span> <span style=color:#ce5c00;font-weight:700>[</span>GCC 8.4.0<span style=color:#ce5c00;font-weight:700>]</span>                                                      <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> python.pip          <span style=color:#000;font-weight:700>|</span> 19.3.1                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> python.version      <span style=color:#000;font-weight:700>|</span> 3.6.9                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> sys.platform        <span style=color:#000;font-weight:700>|</span> linux                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.machine       <span style=color:#000;font-weight:700>|</span> x86_64                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.node          <span style=color:#000;font-weight:700>|</span> 9810ccb69d08                                                     <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.processor     <span style=color:#000;font-weight:700>|</span> x86_64                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.release       <span style=color:#000;font-weight:700>|</span> 4.19.112+                                                        <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.system        <span style=color:#000;font-weight:700>|</span> Linux                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.version       <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020                              |</span>
<span style=color:#000;font-weight:700>|</span> user                <span style=color:#000;font-weight:700>|</span> collab                                                           <span style=color:#000;font-weight:700>|</span>
+---------------------+------------------------------------------------------------------+

+------------------+----------+--------+--------+---------------------+-------+--------------+--------+-------+-------------------------------------+
<span style=color:#000;font-weight:700>|</span> Name             <span style=color:#000;font-weight:700>|</span> Status   <span style=color:#000;font-weight:700>|</span>   Time <span style=color:#000;font-weight:700>|</span>    Sum <span style=color:#000;font-weight:700>|</span> Start               <span style=color:#000;font-weight:700>|</span> tag   <span style=color:#000;font-weight:700>|</span> Node         <span style=color:#000;font-weight:700>|</span> User   <span style=color:#000;font-weight:700>|</span> OS    <span style=color:#000;font-weight:700>|</span> Version                             <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span>------------------+----------+--------+--------+---------------------+-------+--------------+--------+-------+-------------------------------------<span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> data-load        <span style=color:#000;font-weight:700>|</span> failed   <span style=color:#000;font-weight:700>|</span>  0.61  <span style=color:#000;font-weight:700>|</span>  0.61  <span style=color:#000;font-weight:700>|</span> 2021-02-21 21:35:06 <span style=color:#000;font-weight:700>|</span>       <span style=color:#000;font-weight:700>|</span> 9810ccb69d08 <span style=color:#000;font-weight:700>|</span> collab <span style=color:#000;font-weight:700>|</span> Linux <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020 |</span>
<span style=color:#000;font-weight:700>|</span> data-pre-process <span style=color:#000;font-weight:700>|</span> failed   <span style=color:#000;font-weight:700>|</span>  0.076 <span style=color:#000;font-weight:700>|</span>  0.076 <span style=color:#000;font-weight:700>|</span> 2021-02-21 21:35:07 <span style=color:#000;font-weight:700>|</span>       <span style=color:#000;font-weight:700>|</span> 9810ccb69d08 <span style=color:#000;font-weight:700>|</span> collab <span style=color:#000;font-weight:700>|</span> Linux <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020 |</span>
<span style=color:#000;font-weight:700>|</span> compile          <span style=color:#000;font-weight:700>|</span> failed   <span style=color:#000;font-weight:700>|</span>  6.445 <span style=color:#000;font-weight:700>|</span>  6.445 <span style=color:#000;font-weight:700>|</span> 2021-02-21 21:35:07 <span style=color:#000;font-weight:700>|</span>       <span style=color:#000;font-weight:700>|</span> 9810ccb69d08 <span style=color:#000;font-weight:700>|</span> collab <span style=color:#000;font-weight:700>|</span> Linux <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020 |</span>
<span style=color:#000;font-weight:700>|</span> train            <span style=color:#000;font-weight:700>|</span> failed   <span style=color:#000;font-weight:700>|</span> 17.171 <span style=color:#000;font-weight:700>|</span> 17.171 <span style=color:#000;font-weight:700>|</span> 2021-02-21 21:35:13 <span style=color:#000;font-weight:700>|</span>       <span style=color:#000;font-weight:700>|</span> 9810ccb69d08 <span style=color:#000;font-weight:700>|</span> collab <span style=color:#000;font-weight:700>|</span> Linux <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020 |</span>
<span style=color:#000;font-weight:700>|</span> evaluate         <span style=color:#000;font-weight:700>|</span> failed   <span style=color:#000;font-weight:700>|</span>  1.442 <span style=color:#000;font-weight:700>|</span>  1.442 <span style=color:#000;font-weight:700>|</span> 2021-02-21 21:35:31 <span style=color:#000;font-weight:700>|</span>       <span style=color:#000;font-weight:700>|</span> 9810ccb69d08 <span style=color:#000;font-weight:700>|</span> collab <span style=color:#000;font-weight:700>|</span> Linux <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020 |</span>
+------------------+----------+--------+--------+---------------------+-------+--------------+--------+-------+-------------------------------------+

<span style=color:#8f5902;font-style:italic># csv,timer,status,time,sum,start,tag,uname.node,user,uname.system,platform.version</span>
<span style=color:#8f5902;font-style:italic># csv,data-load,failed,0.61,0.61,2021-02-21 21:35:06,,9810ccb69d08,collab,Linux,#1 SMP Thu Jul 23 08:00:38 PDT 2020</span>
<span style=color:#8f5902;font-style:italic># csv,data-pre-process,failed,0.076,0.076,2021-02-21 21:35:07,,9810ccb69d08,collab,Linux,#1 SMP Thu Jul 23 08:00:38 PDT 2020</span>
<span style=color:#8f5902;font-style:italic># csv,compile,failed,6.445,6.445,2021-02-21 21:35:07,,9810ccb69d08,collab,Linux,#1 SMP Thu Jul 23 08:00:38 PDT 2020</span>
<span style=color:#8f5902;font-style:italic># csv,train,failed,17.171,17.171,2021-02-21 21:35:13,,9810ccb69d08,collab,Linux,#1 SMP Thu Jul 23 08:00:38 PDT 2020</span>
<span style=color:#8f5902;font-style:italic># csv,evaluate,failed,1.442,1.442,2021-02-21 21:35:31,,9810ccb69d08,collab,Linux,#1 SMP Thu Jul 23 08:00:38 PDT 2020</span>
</code></pre></div><h3 id=reference>Reference:</h3><p><a href=https://github.com/PacktPublishing/Advanced-Deep-Learning-with-Keras>Orignal Source to Source Code</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-58e48b0ff8be4361592e35752131ed18>13 - MNIST Classification on Google Colab</h1><div class=lead>MNIST Classification on Google Colab</div><div class=aside><table style=width:100%><tr><td><a href=https://colab.research.google.com/github/cybertraining-dsc/cybertraining-dsc.github.io/blob/master/content/en/modules/notebooks/google_colab_mnist_example.ipynb target=_parent><img src=https://colab.research.google.com/assets/colab-badge.svg alt="Open In Colab"></a></td><td><a href=https://github.com/cybertraining-dsc/cybertraining-dsc.github.io/blob/master/content/en/modules/notebooks/google_colab_mnist_example.ipynb target=_parent><img src=https://www.tensorflow.org/images/GitHub-Mark-32px.png alt> View in Github</a></td><td><a href=https://raw.githubusercontent.com/cybertraining-dsc/cybertraining-dsc.github.io/master/content/en/modules/notebooks/google_colab_mnist_example.ipynb download><img src=https://www.tensorflow.org/images/download_logo_32px.png alt></a> Download Notebook</td></tr></table></div><p>In this lesson we discuss in how to create a simple IPython Notebook to solve
an image classification problem. MNIST contains a set of pictures</p><h2 id=import-libraries>Import Libraries</h2><p>Note: <a href=https://python-future.org/quickstart.html>https://python-future.org/quickstart.html</a></p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>__future__</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>absolute_import</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>__future__</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>division</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>__future__</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>print_function</span>

<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>numpy</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>np</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>keras.models</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>Sequential</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>keras.layers</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>Dense</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Activation</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Dropout</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>keras.utils</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>to_categorical</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>plot_model</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>keras.datasets</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>mnist</span>
</code></pre></div><h2 id=warm-up-exercise>Warm Up Exercise</h2><h2 id=pre-process-data>Pre-process data</h2><h3 id=load-data>Load data</h3><p>First we load the data from the inbuilt mnist dataset from Keras
Here we have to split the data set into training and testing data.
The training data or testing data has two components.
Training features and training labels.
For instance every sample in the dataset has a corresponding label.
In Mnist the training sample contains image data represented in terms of
an array. The training labels are from 0-9.</p><p>Here we say x_train for training data features and y_train as the training labels. Same goes for testing data.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_train</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_train</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_test</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>mnist</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>load_data</span><span style=color:#000;font-weight:700>()</span>
</code></pre></div><pre><code>Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz
11493376/11490434 [==============================] - 0s 0us/step
</code></pre><h3 id=identify-number-of-classes>Identify Number of Classes</h3><p>As this is a number classification problem. We need to know how many classes are there.
So we&rsquo;ll count the number of unique labels.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>num_labels</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87>len</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>unique</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>y_train</span><span style=color:#000;font-weight:700>))</span>
</code></pre></div><h3 id=convert-labels-to-one-hot-vector>Convert Labels To One-Hot Vector</h3><p>Read more on one-hot vector.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>y_train</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>to_categorical</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>y_train</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>y_test</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>to_categorical</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>y_test</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><h2 id=image-reshaping>Image Reshaping</h2><p>The training model is designed by considering the data as a vector.
This is a model dependent modification. Here we assume the image is
a squared shape image.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>image_size</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x_train</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>shape</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>]</span>
<span style=color:#000>input_size</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>image_size</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>image_size</span>
</code></pre></div><h2 id=resize-and-normalize>Resize and Normalize</h2><p>The next step is to continue the reshaping to a fit into a vector
and normalize the data. Image values are from 0 - 255, so an
easy way to normalize is to divide by the maximum value.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>x_train</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reshape</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_train</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>[</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>input_size</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#000>x_train</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x_train</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>astype</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;float32&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>/</span> <span style=color:#0000cf;font-weight:700>255</span>
<span style=color:#000>x_test</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reshape</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>[</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>input_size</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#000>x_test</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x_test</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>astype</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;float32&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>/</span> <span style=color:#0000cf;font-weight:700>255</span>
</code></pre></div><h2 id=create-a-keras-model>Create a Keras Model</h2><p>Keras is a neural network library. The summary function provides tabular summary on the model you created. And the plot_model function provides a grpah on the network you created.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#8f5902;font-style:italic># Create Model</span>
<span style=color:#8f5902;font-style:italic># network parameters</span>
<span style=color:#000>batch_size</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>4</span>
<span style=color:#000>hidden_units</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>64</span>

<span style=color:#000>model</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Sequential</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Dense</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>hidden_units</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>input_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>input_size</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Dense</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>num_labels</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Activation</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;softmax&#39;</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>summary</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>plot_model</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>to_file</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;mlp-mnist.png&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>show_shapes</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>True</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><pre><code>Model: &quot;sequential_1&quot;
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_5 (Dense)              (None, 512)               401920    
_________________________________________________________________
dense_6 (Dense)              (None, 10)                5130      
_________________________________________________________________
activation_5 (Activation)    (None, 10)                0         
=================================================================
Total params: 407,050
Trainable params: 407,050
Non-trainable params: 0
_________________________________________________________________
</code></pre><p><img src=https://github.com/cybertraining-dsc/cybertraining-dsc.github.io/blob/master/content/en/modules/bigdataapplications/2020/images/deeplearning/lab1/output_20_1.png alt=images></p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/UagrQBdrkjM style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=compile-and-train>Compile and Train</h2><p>A keras model need to be compiled before it can be used to train
the model. In the compile function, you can provide the optimization
that you want to add, metrics you expect and the type of loss function
you need to use.</p><p>Here we use adam optimizer, a famous optimizer used in neural networks.</p><p>The loss funtion we have used is the categorical_crossentropy.</p><p>Once the model is compiled, then the fit function is called upon passing the number of epochs, traing data and batch size.</p><p>The batch size determines the number of elements used per minibatch in optimizing the function.</p><p><strong>Note: Change the number of epochs, batch size and see what happens.</strong></p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>compile</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>loss</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;categorical_crossentropy&#39;</span><span style=color:#000;font-weight:700>,</span>
              <span style=color:#000>optimizer</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;adam&#39;</span><span style=color:#000;font-weight:700>,</span>
              <span style=color:#000>metrics</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;accuracy&#39;</span><span style=color:#000;font-weight:700>])</span>

<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>fit</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_train</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_train</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>epochs</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>batch_size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>batch_size</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><pre><code>469/469 [==============================] - 3s 7ms/step - loss: 0.3647 - accuracy: 0.8947





&lt;tensorflow.python.keras.callbacks.History at 0x7fe88faf4c50&gt;
</code></pre><h2 id=testing>Testing</h2><p>Now we can test the trained model. Use the evaluate function by passing
test data and batch size and the accuracy and the loss value can be retrieved.</p><p><strong>MNIST_V1.0|Exercise: Try to observe the network behavior by changing the number of epochs, batch size and record the best accuracy that you can gain. Here you can record what happens when you change these values. Describe your observations in 50-100 words.</strong></p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>loss</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>acc</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>evaluate</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>batch_size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>batch_size</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#204a87;font-weight:700>print</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>Test accuracy: </span><span style=color:#4e9a06>%.1f%%</span><span style=color:#4e9a06>&#34;</span> <span style=color:#ce5c00;font-weight:700>%</span> <span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>100.0</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>acc</span><span style=color:#000;font-weight:700>))</span>
</code></pre></div><pre><code>79/79 [==============================] - 0s 4ms/step - loss: 0.2984 - accuracy: 0.9148

Test accuracy: 91.5%
</code></pre><h2 id=final-note>Final Note</h2><p>This programme can be defined as a hello world programme in deep
learning. Objective of this exercise is not to teach you the depths of
deep learning. But to teach you basic concepts that may need to design a
simple network to solve a problem. Before running the whole code, read
all the instructions before a code section.</p><h2 id=homework>Homework</h2><p><strong>Solve Exercise MNIST_V1.0.</strong></p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/lbCyefwZGlI style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h3 id=reference>Reference:</h3><p><a href=https://github.com/PacktPublishing/Advanced-Deep-Learning-with-Keras>Orignal Source to Source Code</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-0d01f29e22a0b117a134031659677469>14 - MNIST With PyTorch</h1><div class=lead>MNIST With PyTorch</div><div class=aside><table style=width:100%><tr><td><a href=https://colab.research.google.com/github/cybertraining-dsc/cybertraining-dsc.github.io/blob/master/content/en/modules/notebooks/mnist_with_pytorch.ipynb target=_parent><img src=https://colab.research.google.com/assets/colab-badge.svg alt="Open In Colab"></a></td><td><a href=https://github.com/cybertraining-dsc/cybertraining-dsc.github.io/blob/master/content/en/modules/notebooks/mnist_with_pytorch.ipynb target=_parent><img src=https://www.tensorflow.org/images/GitHub-Mark-32px.png alt> View in Github</a></td><td><a href=https://raw.githubusercontent.com/cybertraining-dsc/cybertraining-dsc.github.io/master/content/en/modules/notebooks/mnist_with_pytorch.ipynb download><img src=https://www.tensorflow.org/images/download_logo_32px.png alt></a> Download Notebook</td></tr></table></div><p>In this lesson we discuss in how to create a simple IPython Notebook to solve
an image classification problem with Multi Layer Perceptron with PyTorch.</p><h2 id=import-libraries>Import Libraries</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>numpy</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>np</span>
<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>torch</span>
<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>torchvision</span>
<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>matplotlib.pyplot</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>plt</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>torchvision</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>datasets</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>transforms</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>torch</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>nn</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>torch</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>optim</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>time</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>time</span>
<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>os</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>google.colab</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>drive</span>
</code></pre></div><h2 id=pre-process-data>Pre-Process Data</h2><p>Here we download the data using PyTorch data utils and transform the data by using a normalization function.
PyTorch provides a data loader abstraction called a <code>DataLoader</code> where we can set the batch size, data shuffle per batch loading.
Each data loader expecte a Pytorch Dataset.
The DataSet abstraction and DataLoader usage can be found <a href=https://pytorch.org/tutorials/recipes/recipes/loading_data_recipe.html>here</a></p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#8f5902;font-style:italic># Data transformation function </span>
<span style=color:#000>transform</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>transforms</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>Compose</span><span style=color:#000;font-weight:700>([</span><span style=color:#000>transforms</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ToTensor</span><span style=color:#000;font-weight:700>(),</span>
                              <span style=color:#000>transforms</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>Normalize</span><span style=color:#000;font-weight:700>((</span><span style=color:#0000cf;font-weight:700>0.5</span><span style=color:#000;font-weight:700>,),</span> <span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>0.5</span><span style=color:#000;font-weight:700>,)),</span>
                              <span style=color:#000;font-weight:700>])</span>

<span style=color:#8f5902;font-style:italic># DataSet</span>
<span style=color:#000>train_data_set</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>datasets</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>MNIST</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;drive/My Drive/mnist/data/&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>download</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>True</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>train</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>True</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>transform</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>transform</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>validation_data_set</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>datasets</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>MNIST</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;drive/My Drive/mnist/data/&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>download</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>True</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>train</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>False</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>transform</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>transform</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#8f5902;font-style:italic># DataLoader</span>
<span style=color:#000>train_loader</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>torch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>utils</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>data</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>DataLoader</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>train_data_set</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>batch_size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>32</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>shuffle</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>True</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>validation_loader</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>torch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>utils</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>data</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>DataLoader</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>validation_data_set</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>batch_size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>32</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>shuffle</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>True</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><h2 id=define-network>Define Network</h2><p>Here we select the matching input size compared to the network definition.
Here data reshaping or layer reshaping must be done to match input data shape with the network input shape.
Also we define a set of hidden unit sizes along with the output layers size.
The <code>output_size</code> must match with the number of labels associated with the classification problem.
The hidden units can be chosesn depending on the problem. <code>nn.Sequential</code> is one way to create the network.
Here we stack a set of linear layers along with a softmax layer for the classification as the output layer.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>input_size</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>784</span>
<span style=color:#000>hidden_sizes</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>128</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>128</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>64</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>64</span><span style=color:#000;font-weight:700>]</span>
<span style=color:#000>output_size</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>10</span>

<span style=color:#000>model</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>nn</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>Sequential</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>nn</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>Linear</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>input_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>hidden_sizes</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>]),</span>
                      <span style=color:#000>nn</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ReLU</span><span style=color:#000;font-weight:700>(),</span>
                      <span style=color:#000>nn</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>Linear</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>hidden_sizes</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>hidden_sizes</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>]),</span>
                      <span style=color:#000>nn</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ReLU</span><span style=color:#000;font-weight:700>(),</span>
                      <span style=color:#000>nn</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>Linear</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>hidden_sizes</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>hidden_sizes</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>]),</span>
                      <span style=color:#000>nn</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ReLU</span><span style=color:#000;font-weight:700>(),</span>
                      <span style=color:#000>nn</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>Linear</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>hidden_sizes</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>hidden_sizes</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>]),</span>
                      <span style=color:#000>nn</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>ReLU</span><span style=color:#000;font-weight:700>(),</span>
                      <span style=color:#000>nn</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>Linear</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>hidden_sizes</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>output_size</span><span style=color:#000;font-weight:700>),</span>
                      <span style=color:#000>nn</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>LogSoftmax</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>))</span>

                      
<span style=color:#204a87;font-weight:700>print</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>Sequential<span style=color:#ce5c00;font-weight:700>(</span>
  <span style=color:#ce5c00;font-weight:700>(</span>0<span style=color:#ce5c00;font-weight:700>)</span>: Linear<span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>in_features</span><span style=color:#ce5c00;font-weight:700>=</span>784, <span style=color:#000>out_features</span><span style=color:#ce5c00;font-weight:700>=</span>128, <span style=color:#000>bias</span><span style=color:#ce5c00;font-weight:700>=</span>True<span style=color:#ce5c00;font-weight:700>)</span>
  <span style=color:#ce5c00;font-weight:700>(</span>1<span style=color:#ce5c00;font-weight:700>)</span>: ReLU<span style=color:#ce5c00;font-weight:700>()</span>
  <span style=color:#ce5c00;font-weight:700>(</span>2<span style=color:#ce5c00;font-weight:700>)</span>: Linear<span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>in_features</span><span style=color:#ce5c00;font-weight:700>=</span>128, <span style=color:#000>out_features</span><span style=color:#ce5c00;font-weight:700>=</span>128, <span style=color:#000>bias</span><span style=color:#ce5c00;font-weight:700>=</span>True<span style=color:#ce5c00;font-weight:700>)</span>
  <span style=color:#ce5c00;font-weight:700>(</span>3<span style=color:#ce5c00;font-weight:700>)</span>: ReLU<span style=color:#ce5c00;font-weight:700>()</span>
  <span style=color:#ce5c00;font-weight:700>(</span>4<span style=color:#ce5c00;font-weight:700>)</span>: Linear<span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>in_features</span><span style=color:#ce5c00;font-weight:700>=</span>128, <span style=color:#000>out_features</span><span style=color:#ce5c00;font-weight:700>=</span>64, <span style=color:#000>bias</span><span style=color:#ce5c00;font-weight:700>=</span>True<span style=color:#ce5c00;font-weight:700>)</span>
  <span style=color:#ce5c00;font-weight:700>(</span>5<span style=color:#ce5c00;font-weight:700>)</span>: ReLU<span style=color:#ce5c00;font-weight:700>()</span>
  <span style=color:#ce5c00;font-weight:700>(</span>6<span style=color:#ce5c00;font-weight:700>)</span>: Linear<span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>in_features</span><span style=color:#ce5c00;font-weight:700>=</span>64, <span style=color:#000>out_features</span><span style=color:#ce5c00;font-weight:700>=</span>64, <span style=color:#000>bias</span><span style=color:#ce5c00;font-weight:700>=</span>True<span style=color:#ce5c00;font-weight:700>)</span>
  <span style=color:#ce5c00;font-weight:700>(</span>7<span style=color:#ce5c00;font-weight:700>)</span>: ReLU<span style=color:#ce5c00;font-weight:700>()</span>
  <span style=color:#ce5c00;font-weight:700>(</span>8<span style=color:#ce5c00;font-weight:700>)</span>: Linear<span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>in_features</span><span style=color:#ce5c00;font-weight:700>=</span>64, <span style=color:#000>out_features</span><span style=color:#ce5c00;font-weight:700>=</span>10, <span style=color:#000>bias</span><span style=color:#ce5c00;font-weight:700>=</span>True<span style=color:#ce5c00;font-weight:700>)</span>
  <span style=color:#ce5c00;font-weight:700>(</span>9<span style=color:#ce5c00;font-weight:700>)</span>: LogSoftmax<span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>dim</span><span style=color:#ce5c00;font-weight:700>=</span>1<span style=color:#ce5c00;font-weight:700>)</span>
<span style=color:#ce5c00;font-weight:700>)</span>
</code></pre></div><h2 id=define-loss-function-and-optimizer>Define Loss Function and Optimizer</h2><p>Read more about <a href=https://pytorch.org/docs/stable/nn.html#loss-functions>Loss Functions</a> and <a href=https://pytorch.org/docs/stable/optim.html>Optimizers</a>
supported by PyTorch.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>criterion</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>nn</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>NLLLoss</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>optimizer</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>optim</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>SGD</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>parameters</span><span style=color:#000;font-weight:700>(),</span> <span style=color:#000>lr</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>0.003</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>momentum</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>0.9</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><h2 id=train>Train</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>epochs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>5</span>

<span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>epoch</span> <span style=color:#204a87;font-weight:700>in</span> <span style=color:#204a87>range</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>epochs</span><span style=color:#000;font-weight:700>):</span>
    <span style=color:#000>loss_per_epoch</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span>
    <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>images</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>labels</span> <span style=color:#204a87;font-weight:700>in</span> <span style=color:#000>train_loader</span><span style=color:#000;font-weight:700>:</span>
        <span style=color:#000>images</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>images</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>view</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>images</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>shape</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>],</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>)</span>
    
        <span style=color:#8f5902;font-style:italic># Gradients cleared per batch</span>
        <span style=color:#000>optimizer</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>zero_grad</span><span style=color:#000;font-weight:700>()</span>
        
        <span style=color:#8f5902;font-style:italic># Pass input to the model</span>
        <span style=color:#000>output</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>model</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>images</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#8f5902;font-style:italic># Calculate loss after training compared to labels</span>
        <span style=color:#000>loss</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>criterion</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>output</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>labels</span><span style=color:#000;font-weight:700>)</span>
        
        <span style=color:#8f5902;font-style:italic># backpropagation </span>
        <span style=color:#000>loss</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>backward</span><span style=color:#000;font-weight:700>()</span>
        
        <span style=color:#8f5902;font-style:italic># optimizer step to update the weights</span>
        <span style=color:#000>optimizer</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>step</span><span style=color:#000;font-weight:700>()</span>
        
        <span style=color:#000>loss_per_epoch</span> <span style=color:#ce5c00;font-weight:700>+=</span> <span style=color:#000>loss</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>item</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#000>average_loss</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>loss_per_epoch</span> <span style=color:#ce5c00;font-weight:700>/</span> <span style=color:#204a87>len</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>train_loader</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>print</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Epoch {} - Training loss: {}&#34;</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>format</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>epoch</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>average_loss</span><span style=color:#000;font-weight:700>))</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>Epoch <span style=color:#0000cf;font-weight:700>0</span> - Training loss: 1.3052690227402808
Epoch <span style=color:#0000cf;font-weight:700>1</span> - Training loss: 0.33809808635317695
Epoch <span style=color:#0000cf;font-weight:700>2</span> - Training loss: 0.22927882223685922
Epoch <span style=color:#0000cf;font-weight:700>3</span> - Training loss: 0.16807103878669521
Epoch <span style=color:#0000cf;font-weight:700>4</span> - Training loss: 0.1369301250545995
</code></pre></div><h2 id=model-evaluation>Model Evaluation</h2><p>Similar to training data loader, we use the validation loader to load batch by batch and run the feed-forward network to
get the expected prediction and compared to the label associated with the data point.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>correct_predictions</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>all_count</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>0</span>
<span style=color:#8f5902;font-style:italic># enumerate data from the data validation loader (loads a batch at a time)</span>
<span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>batch_id</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>images</span><span style=color:#000;font-weight:700>,</span><span style=color:#000>labels</span><span style=color:#000;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>in</span> <span style=color:#204a87>enumerate</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>validation_loader</span><span style=color:#000;font-weight:700>):</span>
  <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>i</span> <span style=color:#204a87;font-weight:700>in</span> <span style=color:#204a87>range</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87>len</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>labels</span><span style=color:#000;font-weight:700>)):</span>
    <span style=color:#000>img</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>images</span><span style=color:#000;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#000;font-weight:700>]</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>view</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>784</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#8f5902;font-style:italic># at prediction stage, only feed-forward calculation is required. </span>
    <span style=color:#204a87;font-weight:700>with</span> <span style=color:#000>torch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>no_grad</span><span style=color:#000;font-weight:700>():</span>
        <span style=color:#000>logps</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>model</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>img</span><span style=color:#000;font-weight:700>)</span>

    <span style=color:#8f5902;font-style:italic># Output layer of the network uses a LogSoftMax layer</span>
    <span style=color:#8f5902;font-style:italic># Hence the probability must be calculated with the exponential values. </span>
    <span style=color:#8f5902;font-style:italic># The final layer returns an array of probabilities for each label</span>
    <span style=color:#8f5902;font-style:italic># Pick the maximum probability and the corresponding index</span>
    <span style=color:#8f5902;font-style:italic># The corresponding index is the predicted label </span>
    <span style=color:#000>ps</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>torch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>exp</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>logps</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000>probab</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87>list</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ps</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>numpy</span><span style=color:#000;font-weight:700>()[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>])</span>
    <span style=color:#000>pred_label</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>probab</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>index</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87>max</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>probab</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#000>true_label</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>labels</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>numpy</span><span style=color:#000;font-weight:700>()[</span><span style=color:#000>i</span><span style=color:#000;font-weight:700>]</span>
    <span style=color:#204a87;font-weight:700>if</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>true_label</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>pred_label</span><span style=color:#000;font-weight:700>):</span>
      <span style=color:#000>correct_predictions</span> <span style=color:#ce5c00;font-weight:700>+=</span> <span style=color:#0000cf;font-weight:700>1</span>
    <span style=color:#000>all_count</span> <span style=color:#ce5c00;font-weight:700>+=</span> <span style=color:#0000cf;font-weight:700>1</span>

<span style=color:#204a87;font-weight:700>print</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>f</span><span style=color:#4e9a06>&#34;Model Accuracy {(correct_predictions/all_count) * 100} %&#34;</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>Model Accuracy 95.95 %
</code></pre></div><h3 id=reference>Reference:</h3><ol><li><a href=https://pytorch.org/docs/stable/generated/torch.nn.Sequential.html>Torch NN Sequential</a></li><li><a href=https://towardsdatascience.com/handwritten-digit-mnist-pytorch-977b5338e627>Handwritten Digit Recognition Using PyTorch — Intro To Neural Networks</a></li><li><a href=https://nextjournal.com/gkoehler/pytorch-mnist>MNIST Handwritten Digit Recognition in PyTorch</a></li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-e9d8f8a00f057a21693686c040acea8b>15 - MNIST-AutoEncoder Classification on Google Colab</h1><div class=lead>MNIST with AutoEncoder: Classification on Google Colab</div><div class=aside><table style=width:100%><tr><td><a href=https://colab.research.google.com/github/cybertraining-dsc/cybertraining-dsc.github.io/blob/master/content/en/modules/notebooks/mnist_autoencoder.ipynb target=_parent><img src=https://colab.research.google.com/assets/colab-badge.svg alt="Open In Colab"></a></td><td><a href=https://github.com/cybertraining-dsc/cybertraining-dsc.github.io/blob/master/content/en/modules/notebooks/mnist_autoencoder.ipynb target=_parent><img src=https://www.tensorflow.org/images/GitHub-Mark-32px.png alt> View in Github</a></td><td><a href=https://raw.githubusercontent.com/cybertraining-dsc/cybertraining-dsc.github.io/master/content/en/modules/notebooks/mnist_autoencoder.ipynb download><img src=https://www.tensorflow.org/images/download_logo_32px.png alt></a> Download Notebook</td></tr></table></div><h2 id=prerequisites>Prerequisites</h2><p>Install the following packages</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#a40000>!</span> <span style=color:#000>pip3</span> <span style=color:#000>install</span> <span style=color:#000>cloudmesh</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>installer</span>
<span style=color:#a40000>!</span> <span style=color:#000>pip3</span> <span style=color:#000>install</span> <span style=color:#000>cloudmesh</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>common</span>
</code></pre></div><h2 id=import-libraries>Import Libraries</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>tensorflow</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>tf</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>keras.layers</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>Dense</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Input</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>keras.layers</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>Conv2D</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Flatten</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>keras.layers</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>Reshape</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Conv2DTranspose</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>keras.models</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>Model</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>keras.datasets</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>mnist</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>keras.utils</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>plot_model</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>keras</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>backend</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>K</span>

<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>numpy</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>np</span>
<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>matplotlib.pyplot</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>plt</span>
</code></pre></div><h2 id=download-data-and-pre-process>Download Data and Pre-Process</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_train</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_train</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_test</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>mnist</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>load_data</span><span style=color:#000;font-weight:700>()</span>

<span style=color:#000>image_size</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x_train</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>shape</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>]</span>
<span style=color:#000>x_train</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reshape</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_train</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>[</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#000>x_test</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reshape</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>[</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#000>x_train</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x_train</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>astype</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;float32&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>/</span> <span style=color:#0000cf;font-weight:700>255</span>
<span style=color:#000>x_test</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x_test</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>astype</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;float32&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>/</span> <span style=color:#0000cf;font-weight:700>255</span>

<span style=color:#000>input_shape</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>image_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>batch_size</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>32</span>
<span style=color:#000>kernel_size</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>3</span>
<span style=color:#000>latent_dim</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>16</span>
<span style=color:#000>hidden_units</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>32</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>64</span><span style=color:#000;font-weight:700>]</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz
11493376/11490434 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 0s 0us/step
</code></pre></div><h2 id=define-model>Define Model</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>inputs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Input</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>shape</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>input_shape</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;encoder_input&#39;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>inputs</span>
<span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Dense</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>hidden_units</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>activation</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;relu&#39;</span><span style=color:#000;font-weight:700>)(</span><span style=color:#000>x</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Dense</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>hidden_units</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>activation</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;relu&#39;</span><span style=color:#000;font-weight:700>)(</span><span style=color:#000>x</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#000>shape</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>K</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>int_shape</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#8f5902;font-style:italic># generate latent vector</span>
<span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Flatten</span><span style=color:#000;font-weight:700>()(</span><span style=color:#000>x</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>latent</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Dense</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>latent_dim</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;latent_vector&#39;</span><span style=color:#000;font-weight:700>)(</span><span style=color:#000>x</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#8f5902;font-style:italic># instantiate encoder model</span>
<span style=color:#000>encoder</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Model</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>inputs</span><span style=color:#000;font-weight:700>,</span>
                <span style=color:#000>latent</span><span style=color:#000;font-weight:700>,</span>
                <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;encoder&#39;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>encoder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>summary</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>plot_model</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>encoder</span><span style=color:#000;font-weight:700>,</span>
           <span style=color:#000>to_file</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;encoder.png&#39;</span><span style=color:#000;font-weight:700>,</span>
           <span style=color:#000>show_shapes</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>True</span><span style=color:#000;font-weight:700>)</span>


<span style=color:#000>latent_inputs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Input</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>shape</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>latent_dim</span><span style=color:#000;font-weight:700>,),</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;decoder_input&#39;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Dense</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>shape</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>shape</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>shape</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>])(</span><span style=color:#000>latent_inputs</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Reshape</span><span style=color:#000;font-weight:700>((</span><span style=color:#000>shape</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>shape</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>shape</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>]))(</span><span style=color:#000>x</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Dense</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>hidden_units</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>activation</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;relu&#39;</span><span style=color:#000;font-weight:700>)(</span><span style=color:#000>x</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Dense</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>hidden_units</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>activation</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;relu&#39;</span><span style=color:#000;font-weight:700>)(</span><span style=color:#000>x</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#000>outputs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Dense</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>activation</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;relu&#39;</span><span style=color:#000;font-weight:700>)(</span><span style=color:#000>x</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#000>decoder</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Model</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>latent_inputs</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>outputs</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;decoder&#39;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>decoder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>summary</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>plot_model</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>decoder</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>to_file</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;decoder.png&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>show_shapes</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>True</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#000>autoencoder</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Model</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>inputs</span><span style=color:#000;font-weight:700>,</span>
                    <span style=color:#000>decoder</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>encoder</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>inputs</span><span style=color:#000;font-weight:700>)),</span>
                    <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;autoencoder&#39;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>autoencoder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>summary</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>plot_model</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>autoencoder</span><span style=color:#000;font-weight:700>,</span>
           <span style=color:#000>to_file</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;autoencoder.png&#39;</span><span style=color:#000;font-weight:700>,</span>
           <span style=color:#000>show_shapes</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>True</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#000>autoencoder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>compile</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>loss</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;mse&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>optimizer</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;adam&#39;</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>Model: <span style=color:#4e9a06>&#34;encoder&#34;</span>
_________________________________________________________________
Layer <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87>type</span><span style=color:#ce5c00;font-weight:700>)</span>                 Output Shape              Param <span style=color:#8f5902;font-style:italic>#   </span>
<span style=color:#ce5c00;font-weight:700>=================================================================</span>
encoder_input <span style=color:#ce5c00;font-weight:700>(</span>InputLayer<span style=color:#ce5c00;font-weight:700>)</span>   <span style=color:#ce5c00;font-weight:700>[(</span>None, 28, 28, 1<span style=color:#ce5c00;font-weight:700>)]</span>       <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
dense_2 <span style=color:#ce5c00;font-weight:700>(</span>Dense<span style=color:#ce5c00;font-weight:700>)</span>              <span style=color:#ce5c00;font-weight:700>(</span>None, 28, 28, 32<span style=color:#ce5c00;font-weight:700>)</span>        <span style=color:#0000cf;font-weight:700>64</span>        
_________________________________________________________________
dense_3 <span style=color:#ce5c00;font-weight:700>(</span>Dense<span style=color:#ce5c00;font-weight:700>)</span>              <span style=color:#ce5c00;font-weight:700>(</span>None, 28, 28, 64<span style=color:#ce5c00;font-weight:700>)</span>        <span style=color:#0000cf;font-weight:700>2112</span>      
_________________________________________________________________
flatten_1 <span style=color:#ce5c00;font-weight:700>(</span>Flatten<span style=color:#ce5c00;font-weight:700>)</span>          <span style=color:#ce5c00;font-weight:700>(</span>None, 50176<span style=color:#ce5c00;font-weight:700>)</span>             <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
latent_vector <span style=color:#ce5c00;font-weight:700>(</span>Dense<span style=color:#ce5c00;font-weight:700>)</span>        <span style=color:#ce5c00;font-weight:700>(</span>None, 16<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#000>802832</span>    
<span style=color:#ce5c00;font-weight:700>=================================================================</span>
Total params: 805,008
Trainable params: 805,008
Non-trainable params: <span style=color:#0000cf;font-weight:700>0</span>
_________________________________________________________________
Model: <span style=color:#4e9a06>&#34;decoder&#34;</span>
_________________________________________________________________
Layer <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87>type</span><span style=color:#ce5c00;font-weight:700>)</span>                 Output Shape              Param <span style=color:#8f5902;font-style:italic>#   </span>
<span style=color:#ce5c00;font-weight:700>=================================================================</span>
decoder_input <span style=color:#ce5c00;font-weight:700>(</span>InputLayer<span style=color:#ce5c00;font-weight:700>)</span>   <span style=color:#ce5c00;font-weight:700>[(</span>None, 16<span style=color:#ce5c00;font-weight:700>)]</span>              <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
dense_4 <span style=color:#ce5c00;font-weight:700>(</span>Dense<span style=color:#ce5c00;font-weight:700>)</span>              <span style=color:#ce5c00;font-weight:700>(</span>None, 50176<span style=color:#ce5c00;font-weight:700>)</span>             <span style=color:#0000cf;font-weight:700>852992</span>    
_________________________________________________________________
reshape <span style=color:#ce5c00;font-weight:700>(</span>Reshape<span style=color:#ce5c00;font-weight:700>)</span>            <span style=color:#ce5c00;font-weight:700>(</span>None, 28, 28, 64<span style=color:#ce5c00;font-weight:700>)</span>        <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
dense_5 <span style=color:#ce5c00;font-weight:700>(</span>Dense<span style=color:#ce5c00;font-weight:700>)</span>              <span style=color:#ce5c00;font-weight:700>(</span>None, 28, 28, 32<span style=color:#ce5c00;font-weight:700>)</span>        <span style=color:#0000cf;font-weight:700>2080</span>      
_________________________________________________________________
dense_6 <span style=color:#ce5c00;font-weight:700>(</span>Dense<span style=color:#ce5c00;font-weight:700>)</span>              <span style=color:#ce5c00;font-weight:700>(</span>None, 28, 28, 64<span style=color:#ce5c00;font-weight:700>)</span>        <span style=color:#0000cf;font-weight:700>2112</span>      
_________________________________________________________________
dense_7 <span style=color:#ce5c00;font-weight:700>(</span>Dense<span style=color:#ce5c00;font-weight:700>)</span>              <span style=color:#ce5c00;font-weight:700>(</span>None, 28, 28, 1<span style=color:#ce5c00;font-weight:700>)</span>         <span style=color:#000>65</span>        
<span style=color:#ce5c00;font-weight:700>=================================================================</span>
Total params: 857,249
Trainable params: 857,249
Non-trainable params: <span style=color:#0000cf;font-weight:700>0</span>
_________________________________________________________________
Model: <span style=color:#4e9a06>&#34;autoencoder&#34;</span>
_________________________________________________________________
Layer <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87>type</span><span style=color:#ce5c00;font-weight:700>)</span>                 Output Shape              Param <span style=color:#8f5902;font-style:italic>#   </span>
<span style=color:#ce5c00;font-weight:700>=================================================================</span>
encoder_input <span style=color:#ce5c00;font-weight:700>(</span>InputLayer<span style=color:#ce5c00;font-weight:700>)</span>   <span style=color:#ce5c00;font-weight:700>[(</span>None, 28, 28, 1<span style=color:#ce5c00;font-weight:700>)]</span>       <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
encoder <span style=color:#ce5c00;font-weight:700>(</span>Functional<span style=color:#ce5c00;font-weight:700>)</span>         <span style=color:#ce5c00;font-weight:700>(</span>None, 16<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#0000cf;font-weight:700>805008</span>    
_________________________________________________________________
decoder <span style=color:#ce5c00;font-weight:700>(</span>Functional<span style=color:#ce5c00;font-weight:700>)</span>         <span style=color:#ce5c00;font-weight:700>(</span>None, 28, 28, 1<span style=color:#ce5c00;font-weight:700>)</span>         <span style=color:#000>857249</span>    
<span style=color:#ce5c00;font-weight:700>=================================================================</span>
Total params: 1,662,257
Trainable params: 1,662,257
Non-trainable params: <span style=color:#0000cf;font-weight:700>0</span>
</code></pre></div><h2 id=train>Train</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>autoencoder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>fit</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_train</span><span style=color:#000;font-weight:700>,</span>
                <span style=color:#000>x_train</span><span style=color:#000;font-weight:700>,</span>
                <span style=color:#000>validation_data</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>x_test</span><span style=color:#000;font-weight:700>),</span>
                <span style=color:#000>epochs</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
                <span style=color:#000>batch_size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>batch_size</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>1875/1875 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 112s 60ms/step - loss: 0.0268 - val_loss: 0.0131

&lt;tensorflow.python.keras.callbacks.History at 0x7f3ecb2e0be0&gt;
</code></pre></div><h2 id=test>Test</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>x_decoded</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>autoencoder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>predict</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>79/79 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 7s 80ms/step - loss: 0.2581 - accuracy: 0.9181

Test accuracy: 91.8%
</code></pre></div><h2 id=visualize>Visualize</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>imgs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>concatenate</span><span style=color:#000;font-weight:700>([</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>[:</span><span style=color:#0000cf;font-weight:700>8</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>x_decoded</span><span style=color:#000;font-weight:700>[:</span><span style=color:#0000cf;font-weight:700>8</span><span style=color:#000;font-weight:700>]])</span>
<span style=color:#000>imgs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>imgs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reshape</span><span style=color:#000;font-weight:700>((</span><span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>imgs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>vstack</span><span style=color:#000;font-weight:700>([</span><span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>hstack</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>i</span><span style=color:#000;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>i</span> <span style=color:#204a87;font-weight:700>in</span> <span style=color:#000>imgs</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>figure</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>axis</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;off&#39;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>title</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;Input: 1st 2 rows, Decoded: last 2 rows&#39;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>imshow</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>imgs</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>interpolation</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;none&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>cmap</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;gray&#39;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>savefig</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;input_and_decoded.png&#39;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>plt</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>show</span><span style=color:#000;font-weight:700>()</span>
</code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-777bb219db496cfedd1a8b5f23f5859f>16 - MNIST-CNN Classification on Google Colab</h1><div class=lead>MNIST with Convolutional Neural Networks: Classification on Google Colab</div><div class=aside><table style=width:100%><tr><td><a href=https://colab.research.google.com/github/cybertraining-dsc/cybertraining-dsc.github.io/blob/master/content/en/modules/notebooks/mnist_cnn.ipynb target=_parent><img src=https://colab.research.google.com/assets/colab-badge.svg alt="Open In Colab"></a></td><td><a href=https://github.com/cybertraining-dsc/cybertraining-dsc.github.io/blob/master/content/en/modules/notebooks/mnist_cnn.ipynb target=_parent><img src=https://www.tensorflow.org/images/GitHub-Mark-32px.png alt> View in Github</a></td><td><a href=https://raw.githubusercontent.com/cybertraining-dsc/cybertraining-dsc.github.io/master/content/en/modules/notebooks/mnist_cnn.ipynb download><img src=https://www.tensorflow.org/images/download_logo_32px.png alt></a> Download Notebook</td></tr></table></div><h2 id=prerequisites>Prerequisites</h2><p>Install the following packages</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#a40000>!</span> <span style=color:#000>pip3</span> <span style=color:#000>install</span> <span style=color:#000>cloudmesh</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>installer</span>
<span style=color:#a40000>!</span> <span style=color:#000>pip3</span> <span style=color:#000>install</span> <span style=color:#000>cloudmesh</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>common</span>
</code></pre></div><h2 id=import-libraries>Import Libraries</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>__future__</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>absolute_import</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>__future__</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>division</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>__future__</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>print_function</span>

<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>numpy</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>np</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>keras.models</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>Sequential</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>keras.layers</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>Activation</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Dense</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Dropout</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>keras.layers</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>Conv2D</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>MaxPooling2D</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Flatten</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>AveragePooling2D</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>keras.utils</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>to_categorical</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>plot_model</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>keras.datasets</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>mnist</span>
</code></pre></div><h2 id=download-data-and-pre-process>Download Data and Pre-Process</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_train</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_train</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_test</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>mnist</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>load_data</span><span style=color:#000;font-weight:700>()</span>

<span style=color:#000>num_labels</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87>len</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>unique</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>y_train</span><span style=color:#000;font-weight:700>))</span>

<span style=color:#000>y_train</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>to_categorical</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>y_train</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>y_test</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>to_categorical</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>y_test</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#000>image_size</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x_train</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>shape</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>]</span>
<span style=color:#000>x_train</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reshape</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_train</span><span style=color:#000;font-weight:700>,[</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#000>x_test</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reshape</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>,[</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#000>x_train</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x_train</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>astype</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;float32&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>/</span> <span style=color:#0000cf;font-weight:700>255</span>
<span style=color:#000>x_test</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x_test</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>astype</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;float32&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>/</span> <span style=color:#0000cf;font-weight:700>255</span>

<span style=color:#000>input_shape</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>image_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#204a87;font-weight:700>print</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>input_shape</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>batch_size</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>128</span>
<span style=color:#000>kernel_size</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>3</span>
<span style=color:#000>pool_size</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>2</span>
<span style=color:#000>filters</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>64</span>
<span style=color:#000>dropout</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0.2</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz
11493376/11490434 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 0s 0us/step
<span style=color:#ce5c00;font-weight:700>(</span>28, 28, 1<span style=color:#ce5c00;font-weight:700>)</span>
</code></pre></div><h2 id=define-model>Define Model</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>model</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Sequential</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Conv2D</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>filters</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>filters</span><span style=color:#000;font-weight:700>,</span>
                 <span style=color:#000>kernel_size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>kernel_size</span><span style=color:#000;font-weight:700>,</span>
                 <span style=color:#000>activation</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;relu&#39;</span><span style=color:#000;font-weight:700>,</span>
                 <span style=color:#000>input_shape</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>input_shape</span><span style=color:#000;font-weight:700>,</span>
                 <span style=color:#000>padding</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;same&#39;</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>MaxPooling2D</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>pool_size</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Conv2D</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>filters</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>filters</span><span style=color:#000;font-weight:700>,</span>
                 <span style=color:#000>kernel_size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>kernel_size</span><span style=color:#000;font-weight:700>,</span>
                 <span style=color:#000>activation</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;relu&#39;</span><span style=color:#000;font-weight:700>,</span>
                 <span style=color:#000>input_shape</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>input_shape</span><span style=color:#000;font-weight:700>,</span>
                 <span style=color:#000>padding</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;same&#39;</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>MaxPooling2D</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>pool_size</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Conv2D</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>filters</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>filters</span><span style=color:#000;font-weight:700>,</span>
                 <span style=color:#000>kernel_size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>kernel_size</span><span style=color:#000;font-weight:700>,</span>
                 <span style=color:#000>activation</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;relu&#39;</span><span style=color:#000;font-weight:700>,</span>
                 <span style=color:#000>padding</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;same&#39;</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>MaxPooling2D</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>pool_size</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Conv2D</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>filters</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>filters</span><span style=color:#000;font-weight:700>,</span>
                 <span style=color:#000>kernel_size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>kernel_size</span><span style=color:#000;font-weight:700>,</span>
                 <span style=color:#000>activation</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;relu&#39;</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Flatten</span><span style=color:#000;font-weight:700>())</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Dropout</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>dropout</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Dense</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>num_labels</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Activation</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;softmax&#39;</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>summary</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>plot_model</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>to_file</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;cnn-mnist.png&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>show_shapes</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>True</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>Model: <span style=color:#4e9a06>&#34;sequential_1&#34;</span>
_________________________________________________________________
Layer <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87>type</span><span style=color:#ce5c00;font-weight:700>)</span>                 Output Shape              Param <span style=color:#8f5902;font-style:italic>#   </span>
<span style=color:#ce5c00;font-weight:700>=================================================================</span>
conv2d_4 <span style=color:#ce5c00;font-weight:700>(</span>Conv2D<span style=color:#ce5c00;font-weight:700>)</span>            <span style=color:#ce5c00;font-weight:700>(</span>None, 28, 28, 64<span style=color:#ce5c00;font-weight:700>)</span>        <span style=color:#0000cf;font-weight:700>640</span>       
_________________________________________________________________
max_pooling2d_3 <span style=color:#ce5c00;font-weight:700>(</span>MaxPooling2 <span style=color:#ce5c00;font-weight:700>(</span>None, 14, 14, 64<span style=color:#ce5c00;font-weight:700>)</span>        <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
conv2d_5 <span style=color:#ce5c00;font-weight:700>(</span>Conv2D<span style=color:#ce5c00;font-weight:700>)</span>            <span style=color:#ce5c00;font-weight:700>(</span>None, 14, 14, 64<span style=color:#ce5c00;font-weight:700>)</span>        <span style=color:#0000cf;font-weight:700>36928</span>     
_________________________________________________________________
max_pooling2d_4 <span style=color:#ce5c00;font-weight:700>(</span>MaxPooling2 <span style=color:#ce5c00;font-weight:700>(</span>None, 7, 7, 64<span style=color:#ce5c00;font-weight:700>)</span>          <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
conv2d_6 <span style=color:#ce5c00;font-weight:700>(</span>Conv2D<span style=color:#ce5c00;font-weight:700>)</span>            <span style=color:#ce5c00;font-weight:700>(</span>None, 7, 7, 64<span style=color:#ce5c00;font-weight:700>)</span>          <span style=color:#0000cf;font-weight:700>36928</span>     
_________________________________________________________________
max_pooling2d_5 <span style=color:#ce5c00;font-weight:700>(</span>MaxPooling2 <span style=color:#ce5c00;font-weight:700>(</span>None, 3, 3, 64<span style=color:#ce5c00;font-weight:700>)</span>          <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
conv2d_7 <span style=color:#ce5c00;font-weight:700>(</span>Conv2D<span style=color:#ce5c00;font-weight:700>)</span>            <span style=color:#ce5c00;font-weight:700>(</span>None, 1, 1, 64<span style=color:#ce5c00;font-weight:700>)</span>          <span style=color:#0000cf;font-weight:700>36928</span>     
_________________________________________________________________
flatten_1 <span style=color:#ce5c00;font-weight:700>(</span>Flatten<span style=color:#ce5c00;font-weight:700>)</span>          <span style=color:#ce5c00;font-weight:700>(</span>None, 64<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
dropout_1 <span style=color:#ce5c00;font-weight:700>(</span>Dropout<span style=color:#ce5c00;font-weight:700>)</span>          <span style=color:#ce5c00;font-weight:700>(</span>None, 64<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
dense_1 <span style=color:#ce5c00;font-weight:700>(</span>Dense<span style=color:#ce5c00;font-weight:700>)</span>              <span style=color:#ce5c00;font-weight:700>(</span>None, 10<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#0000cf;font-weight:700>650</span>       
_________________________________________________________________
activation_1 <span style=color:#ce5c00;font-weight:700>(</span>Activation<span style=color:#ce5c00;font-weight:700>)</span>    <span style=color:#ce5c00;font-weight:700>(</span>None, 10<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#000>0</span>         
<span style=color:#ce5c00;font-weight:700>=================================================================</span>
Total params: 112,074
Trainable params: 112,074
Non-trainable params: <span style=color:#0000cf;font-weight:700>0</span>
_________________________________________________________________
</code></pre></div><h2 id=train>Train</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>compile</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>loss</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;categorical_crossentropy&#39;</span><span style=color:#000;font-weight:700>,</span>
              <span style=color:#000>optimizer</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;adam&#39;</span><span style=color:#000;font-weight:700>,</span>
              <span style=color:#000>metrics</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;accuracy&#39;</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#8f5902;font-style:italic># train the network</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>fit</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_train</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_train</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>epochs</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>batch_size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>batch_size</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>469/469 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 125s 266ms/step - loss: 0.6794 - accuracy: 0.7783

&lt;tensorflow.python.keras.callbacks.History at 0x7f35d4b104e0&gt;
</code></pre></div><h2 id=test>Test</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>loss</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>acc</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>evaluate</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>batch_size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>batch_size</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#204a87;font-weight:700>print</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>Test accuracy: </span><span style=color:#4e9a06>%.1f%%</span><span style=color:#4e9a06>&#34;</span> <span style=color:#ce5c00;font-weight:700>%</span> <span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>100.0</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>acc</span><span style=color:#000;font-weight:700>))</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>79/79 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 6s 68ms/step - loss: 0.0608 - accuracy: 0.9813

Test accuracy: 98.1%
</code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-cf2c391da95ceed7375b8fe8248aa3f2>17 - MNIST-LSTM Classification on Google Colab</h1><div class=lead>MNIST-LSTM Classification on Google Colab</div><div class=aside><table style=width:100%><tr><td><a href=https://colab.research.google.com/github/cybertraining-dsc/cybertraining-dsc.github.io/blob/master/content/en/modules/notebooks/mnist_lstm.ipynb target=_parent><img src=https://colab.research.google.com/assets/colab-badge.svg alt="Open In Colab"></a></td><td><a href=https://github.com/cybertraining-dsc/cybertraining-dsc.github.io/blob/master/content/en/modules/notebooks/mnist_lstm.ipynb target=_parent><img src=https://www.tensorflow.org/images/GitHub-Mark-32px.png alt> View in Github</a></td><td><a href=https://raw.githubusercontent.com/cybertraining-dsc/cybertraining-dsc.github.io/master/content/en/modules/notebooks/mnist_lstm.ipynb download><img src=https://www.tensorflow.org/images/download_logo_32px.png alt></a> Download Notebook</td></tr></table></div><h2 id=pre-requisites>Pre-requisites</h2><p>Install the following Python packages</p><ol><li>cloudmesh-installer</li><li>cloudmesh-common</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>pip3 install cloudmesh-installer
pip3 install cloudmesh-common
</code></pre></div><h2 id=sample-lstm-with-tensorflow-keras>Sample LSTM with Tensorflow Keras</h2><h2 id=import-libraries>Import Libraries</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>__future__</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>absolute_import</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>__future__</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>division</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>__future__</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>print_function</span>

<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>numpy</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>np</span>
<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>tensorflow</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>tf</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>tensorflow.keras.models</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>Sequential</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>tensorflow.keras.layers</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>Dense</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Activation</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>SimpleRNN</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>InputLayer</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>LSTM</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>tensorflow.keras.utils</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>to_categorical</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>plot_model</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>tensorflow.keras.datasets</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>mnist</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>cloudmesh.common.StopWatch</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>StopWatch</span>
</code></pre></div><h2 id=download-data-and-pre-process>Download Data and Pre-Process</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>start</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;data-load&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000;font-weight:700>(</span><span style=color:#000>x_train</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_train</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_test</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>mnist</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>load_data</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>stop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;data-load&#34;</span><span style=color:#000;font-weight:700>)</span>


<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>start</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;data-pre-process&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>num_labels</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87>len</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>unique</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>y_train</span><span style=color:#000;font-weight:700>))</span>


<span style=color:#000>y_train</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>to_categorical</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>y_train</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>y_test</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>to_categorical</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>y_test</span><span style=color:#000;font-weight:700>)</span>


<span style=color:#000>image_size</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x_train</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>shape</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>]</span>
<span style=color:#000>x_train</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reshape</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_train</span><span style=color:#000;font-weight:700>,[</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#000>x_test</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reshape</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>,[</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#000>x_train</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x_train</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>astype</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;float32&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>/</span> <span style=color:#0000cf;font-weight:700>255</span>
<span style=color:#000>x_test</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x_test</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>astype</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;float32&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>/</span> <span style=color:#0000cf;font-weight:700>255</span>
<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>stop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;data-pre-process&#34;</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#000>input_shape</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>image_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>batch_size</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>128</span>
<span style=color:#000>units</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>256</span>
<span style=color:#000>dropout</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0.2</span>
</code></pre></div><h2 id=define-model>Define Model</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>start</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;compile&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>model</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Sequential</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>LSTM</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>units</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>units</span><span style=color:#000;font-weight:700>,</span>                      
                     <span style=color:#000>input_shape</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>input_shape</span><span style=color:#000;font-weight:700>,</span>
                     <span style=color:#000>return_sequences</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>True</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>LSTM</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>units</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>units</span><span style=color:#000;font-weight:700>,</span> 
                     <span style=color:#000>dropout</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>dropout</span><span style=color:#000;font-weight:700>,</span>                      
                     <span style=color:#000>return_sequences</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>True</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>LSTM</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>units</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>units</span><span style=color:#000;font-weight:700>,</span> 
                     <span style=color:#000>dropout</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>dropout</span><span style=color:#000;font-weight:700>,</span>                      
                     <span style=color:#000>return_sequences</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>False</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Dense</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>num_labels</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Activation</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;softmax&#39;</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>summary</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>plot_model</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>to_file</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;rnn-mnist.png&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>show_shapes</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>True</span><span style=color:#000;font-weight:700>)</span>


<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>compile</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>loss</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;categorical_crossentropy&#39;</span><span style=color:#000;font-weight:700>,</span>
              <span style=color:#000>optimizer</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;sgd&#39;</span><span style=color:#000;font-weight:700>,</span>
              <span style=color:#000>metrics</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;accuracy&#39;</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>stop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;compile&#34;</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>Model: <span style=color:#4e9a06>&#34;sequential_1&#34;</span>
_________________________________________________________________
Layer <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87>type</span><span style=color:#ce5c00;font-weight:700>)</span>                 Output Shape              Param <span style=color:#8f5902;font-style:italic>#   </span>
<span style=color:#ce5c00;font-weight:700>=================================================================</span>
lstm_3 <span style=color:#ce5c00;font-weight:700>(</span>LSTM<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#ce5c00;font-weight:700>(</span>None, 28, 256<span style=color:#ce5c00;font-weight:700>)</span>           <span style=color:#0000cf;font-weight:700>291840</span>    
_________________________________________________________________
lstm_4 <span style=color:#ce5c00;font-weight:700>(</span>LSTM<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#ce5c00;font-weight:700>(</span>None, 28, 256<span style=color:#ce5c00;font-weight:700>)</span>           <span style=color:#0000cf;font-weight:700>525312</span>    
_________________________________________________________________
lstm_5 <span style=color:#ce5c00;font-weight:700>(</span>LSTM<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#ce5c00;font-weight:700>(</span>None, 256<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>525312</span>    
_________________________________________________________________
dense_1 <span style=color:#ce5c00;font-weight:700>(</span>Dense<span style=color:#ce5c00;font-weight:700>)</span>              <span style=color:#ce5c00;font-weight:700>(</span>None, 10<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#0000cf;font-weight:700>2570</span>      
_________________________________________________________________
activation_1 <span style=color:#ce5c00;font-weight:700>(</span>Activation<span style=color:#ce5c00;font-weight:700>)</span>    <span style=color:#ce5c00;font-weight:700>(</span>None, 10<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#000>0</span>         
<span style=color:#ce5c00;font-weight:700>=================================================================</span>
Total params: 1,345,034
Trainable params: 1,345,034
Non-trainable params: <span style=color:#0000cf;font-weight:700>0</span>
</code></pre></div><h2 id=train>Train</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>start</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;train&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>fit</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_train</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_train</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>epochs</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>batch_size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>batch_size</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>stop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;train&#34;</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>469/469 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 378s 796ms/step - loss: 2.2689 - accuracy: 0.2075
</code></pre></div><h2 id=test>Test</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>start</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;evaluate&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>loss</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>acc</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>evaluate</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>batch_size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>batch_size</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#204a87;font-weight:700>print</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>Test accuracy: </span><span style=color:#4e9a06>%.1f%%</span><span style=color:#4e9a06>&#34;</span> <span style=color:#ce5c00;font-weight:700>%</span> <span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>100.0</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>acc</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>stop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;evaluate&#34;</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>benchmark</span><span style=color:#000;font-weight:700>()</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>79/79 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 22s 260ms/step - loss: 1.9646 - accuracy: 0.3505

Test accuracy: 35.0%

+---------------------+------------------------------------------------------------------+
<span style=color:#000;font-weight:700>|</span> Attribute           <span style=color:#000;font-weight:700>|</span> Value                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span>---------------------+------------------------------------------------------------------<span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> BUG_REPORT_URL      <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;https://bugs.launchpad.net/ubuntu/&#34;</span>                             <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> DISTRIB_CODENAME    <span style=color:#000;font-weight:700>|</span> bionic                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> DISTRIB_DESCRIPTION <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;Ubuntu 18.04.5 LTS&#34;</span>                                             <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> DISTRIB_ID          <span style=color:#000;font-weight:700>|</span> Ubuntu                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> DISTRIB_RELEASE     <span style=color:#000;font-weight:700>|</span> 18.04                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> HOME_URL            <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;https://www.ubuntu.com/&#34;</span>                                        <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> ID                  <span style=color:#000;font-weight:700>|</span> ubuntu                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> ID_LIKE             <span style=color:#000;font-weight:700>|</span> debian                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> NAME                <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;Ubuntu&#34;</span>                                                         <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> PRETTY_NAME         <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;Ubuntu 18.04.5 LTS&#34;</span>                                             <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> PRIVACY_POLICY_URL  <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;https://www.ubuntu.com/legal/terms-and-policies/privacy-policy&#34;</span> <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> SUPPORT_URL         <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;https://help.ubuntu.com/&#34;</span>                                       <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> UBUNTU_CODENAME     <span style=color:#000;font-weight:700>|</span> bionic                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> VERSION             <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;18.04.5 LTS (Bionic Beaver)&#34;</span>                                    <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> VERSION_CODENAME    <span style=color:#000;font-weight:700>|</span> bionic                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> VERSION_ID          <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;18.04&#34;</span>                                                          <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> cpu_count           <span style=color:#000;font-weight:700>|</span> <span style=color:#0000cf;font-weight:700>2</span>                                                                <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.active          <span style=color:#000;font-weight:700>|</span> 1.5 GiB                                                          <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.available       <span style=color:#000;font-weight:700>|</span> 11.4 GiB                                                         <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.free            <span style=color:#000;font-weight:700>|</span> 9.3 GiB                                                          <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.inactive        <span style=color:#000;font-weight:700>|</span> 1.7 GiB                                                          <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.percent         <span style=color:#000;font-weight:700>|</span> 10.4 %                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.total           <span style=color:#000;font-weight:700>|</span> 12.7 GiB                                                         <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.used            <span style=color:#000;font-weight:700>|</span> 1.3 GiB                                                          <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> platform.version    <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020                              |</span>
<span style=color:#000;font-weight:700>|</span> python              <span style=color:#000;font-weight:700>|</span> 3.6.9 <span style=color:#ce5c00;font-weight:700>(</span>default, Oct  <span style=color:#0000cf;font-weight:700>8</span> 2020, 12:12:24<span style=color:#ce5c00;font-weight:700>)</span>                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span>                     <span style=color:#000;font-weight:700>|</span> <span style=color:#ce5c00;font-weight:700>[</span>GCC 8.4.0<span style=color:#ce5c00;font-weight:700>]</span>                                                      <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> python.pip          <span style=color:#000;font-weight:700>|</span> 19.3.1                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> python.version      <span style=color:#000;font-weight:700>|</span> 3.6.9                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> sys.platform        <span style=color:#000;font-weight:700>|</span> linux                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.machine       <span style=color:#000;font-weight:700>|</span> x86_64                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.node          <span style=color:#000;font-weight:700>|</span> 351ef0f61c92                                                     <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.processor     <span style=color:#000;font-weight:700>|</span> x86_64                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.release       <span style=color:#000;font-weight:700>|</span> 4.19.112+                                                        <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.system        <span style=color:#000;font-weight:700>|</span> Linux                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.version       <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020                              |</span>
<span style=color:#000;font-weight:700>|</span> user                <span style=color:#000;font-weight:700>|</span> collab                                                           <span style=color:#000;font-weight:700>|</span>
+---------------------+------------------------------------------------------------------+

+------------------+----------+---------+---------+---------------------+-------+--------------+--------+-------+-------------------------------------+
<span style=color:#000;font-weight:700>|</span> Name             <span style=color:#000;font-weight:700>|</span> Status   <span style=color:#000;font-weight:700>|</span>    Time <span style=color:#000;font-weight:700>|</span>     Sum <span style=color:#000;font-weight:700>|</span> Start               <span style=color:#000;font-weight:700>|</span> tag   <span style=color:#000;font-weight:700>|</span> Node         <span style=color:#000;font-weight:700>|</span> User   <span style=color:#000;font-weight:700>|</span> OS    <span style=color:#000;font-weight:700>|</span> Version                             <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span>------------------+----------+---------+---------+---------------------+-------+--------------+--------+-------+-------------------------------------<span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> data-load        <span style=color:#000;font-weight:700>|</span> failed   <span style=color:#000;font-weight:700>|</span>   0.354 <span style=color:#000;font-weight:700>|</span>   0.967 <span style=color:#000;font-weight:700>|</span> 2021-02-18 15:27:21 <span style=color:#000;font-weight:700>|</span>       <span style=color:#000;font-weight:700>|</span> 351ef0f61c92 <span style=color:#000;font-weight:700>|</span> collab <span style=color:#000;font-weight:700>|</span> Linux <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020 |</span>
<span style=color:#000;font-weight:700>|</span> data-pre-process <span style=color:#000;font-weight:700>|</span> failed   <span style=color:#000;font-weight:700>|</span>   0.098 <span style=color:#000;font-weight:700>|</span>   0.198 <span style=color:#000;font-weight:700>|</span> 2021-02-18 15:27:21 <span style=color:#000;font-weight:700>|</span>       <span style=color:#000;font-weight:700>|</span> 351ef0f61c92 <span style=color:#000;font-weight:700>|</span> collab <span style=color:#000;font-weight:700>|</span> Linux <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020 |</span>
<span style=color:#000;font-weight:700>|</span> compile          <span style=color:#000;font-weight:700>|</span> failed   <span style=color:#000;font-weight:700>|</span>   0.932 <span style=color:#000;font-weight:700>|</span>   2.352 <span style=color:#000;font-weight:700>|</span> 2021-02-18 15:27:23 <span style=color:#000;font-weight:700>|</span>       <span style=color:#000;font-weight:700>|</span> 351ef0f61c92 <span style=color:#000;font-weight:700>|</span> collab <span style=color:#000;font-weight:700>|</span> Linux <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020 |</span>
<span style=color:#000;font-weight:700>|</span> train            <span style=color:#000;font-weight:700>|</span> failed   <span style=color:#000;font-weight:700>|</span> 377.842 <span style=color:#000;font-weight:700>|</span> 377.842 <span style=color:#000;font-weight:700>|</span> 2021-02-18 15:27:26 <span style=color:#000;font-weight:700>|</span>       <span style=color:#000;font-weight:700>|</span> 351ef0f61c92 <span style=color:#000;font-weight:700>|</span> collab <span style=color:#000;font-weight:700>|</span> Linux <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020 |</span>
<span style=color:#000;font-weight:700>|</span> evaluate         <span style=color:#000;font-weight:700>|</span> failed   <span style=color:#000;font-weight:700>|</span>  21.689 <span style=color:#000;font-weight:700>|</span>  21.689 <span style=color:#000;font-weight:700>|</span> 2021-02-18 15:33:44 <span style=color:#000;font-weight:700>|</span>       <span style=color:#000;font-weight:700>|</span> 351ef0f61c92 <span style=color:#000;font-weight:700>|</span> collab <span style=color:#000;font-weight:700>|</span> Linux <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020 |</span>
+------------------+----------+---------+---------+---------------------+-------+--------------+--------+-------+-------------------------------------+

<span style=color:#8f5902;font-style:italic># csv,timer,status,time,sum,start,tag,uname.node,user,uname.system,platform.version</span>
<span style=color:#8f5902;font-style:italic># csv,data-load,failed,0.354,0.967,2021-02-18 15:27:21,,351ef0f61c92,collab,Linux,#1 SMP Thu Jul 23 08:00:38 PDT 2020</span>
<span style=color:#8f5902;font-style:italic># csv,data-pre-process,failed,0.098,0.198,2021-02-18 15:27:21,,351ef0f61c92,collab,Linux,#1 SMP Thu Jul 23 08:00:38 PDT 2020</span>
<span style=color:#8f5902;font-style:italic># csv,compile,failed,0.932,2.352,2021-02-18 15:27:23,,351ef0f61c92,collab,Linux,#1 SMP Thu Jul 23 08:00:38 PDT 2020</span>
<span style=color:#8f5902;font-style:italic># csv,train,failed,377.842,377.842,2021-02-18 15:27:26,,351ef0f61c92,collab,Linux,#1 SMP Thu Jul 23 08:00:38 PDT 2020</span>
<span style=color:#8f5902;font-style:italic># csv,evaluate,failed,21.689,21.689,2021-02-18 15:33:44,,351ef0f61c92,collab,Linux,#1 SMP Thu Jul 23 08:00:38 PDT 2020</span>
</code></pre></div><h3 id=reference>Reference:</h3><p><a href=https://github.com/PacktPublishing/Advanced-Deep-Learning-with-Keras>Orignal Source to Source Code</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-1ffde8dd2da86844779bae2367f007cb>18 - MNIST-MLP Classification on Google Colab</h1><div class=lead>MNIST-MLP Classification on Google Colab</div><div class=aside><table style=width:100%><tr><td><a href=https://colab.research.google.com/github/cybertraining-dsc/cybertraining-dsc.github.io/blob/master/content/en/modules/notebooks/mlp_mnist.ipynb target=_parent><img src=https://colab.research.google.com/assets/colab-badge.svg alt="Open In Colab"></a></td><td><a href=https://github.com/cybertraining-dsc/cybertraining-dsc.github.io/blob/master/content/en/modules/notebooks/mlp_mnist.ipynb target=_parent><img src=https://www.tensorflow.org/images/GitHub-Mark-32px.png alt> View in Github</a></td><td><a href=https://raw.githubusercontent.com/cybertraining-dsc/cybertraining-dsc.github.io/master/content/en/modules/notebooks/mlp_mnist.ipynb download><img src=https://www.tensorflow.org/images/download_logo_32px.png alt></a> Download Notebook</td></tr></table></div><p>In this lesson we discuss in how to create a simple IPython Notebook to solve
an image classification problem with Multi Layer Perceptron.</p><h2 id=pre-requisites>Pre-requisites</h2><p>Install the following Python packages</p><ol><li>cloudmesh-installer</li><li>cloudmesh-common</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>pip3 install cloudmesh-installer
pip3 install cloudmesh-common
</code></pre></div><h2 id=sample-mlp-with-tensorflow-keras>Sample MLP with Tensorflow Keras</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>__future__</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>absolute_import</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>__future__</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>division</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>__future__</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>print_function</span>

<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>time</span> 

<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>numpy</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>np</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>keras.models</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>Sequential</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>keras.layers</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>Dense</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Activation</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Dropout</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>keras.utils</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>to_categorical</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>plot_model</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>keras.datasets</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>mnist</span>
<span style=color:#8f5902;font-style:italic>#import pydotplus</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>keras.utils.vis_utils</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>model_to_dot</span>
<span style=color:#8f5902;font-style:italic>#from keras.utils.vis_utils import pydot</span>


<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>cloudmesh.common.StopWatch</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>StopWatch</span>

<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>start</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;data-load&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000;font-weight:700>(</span><span style=color:#000>x_train</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_train</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_test</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>mnist</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>load_data</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>stop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;data-load&#34;</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#000>num_labels</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87>len</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>unique</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>y_train</span><span style=color:#000;font-weight:700>))</span>


<span style=color:#000>y_train</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>to_categorical</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>y_train</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>y_test</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>to_categorical</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>y_test</span><span style=color:#000;font-weight:700>)</span>


<span style=color:#000>image_size</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x_train</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>shape</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>]</span>
<span style=color:#000>input_size</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>image_size</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>image_size</span>


<span style=color:#000>x_train</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reshape</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_train</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>[</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>input_size</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#000>x_train</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x_train</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>astype</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;float32&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>/</span> <span style=color:#0000cf;font-weight:700>255</span>
<span style=color:#000>x_test</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reshape</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>[</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>input_size</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#000>x_test</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x_test</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>astype</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;float32&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>/</span> <span style=color:#0000cf;font-weight:700>255</span>

<span style=color:#000>batch_size</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>128</span>
<span style=color:#000>hidden_units</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>512</span>
<span style=color:#000>dropout</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0.45</span>

<span style=color:#000>model</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Sequential</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Dense</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>hidden_units</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>input_dim</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>input_size</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Activation</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;relu&#39;</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Dropout</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>dropout</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Dense</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>hidden_units</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Activation</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;relu&#39;</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Dropout</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>dropout</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Dense</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>hidden_units</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Activation</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;relu&#39;</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Dropout</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>dropout</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Dense</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>hidden_units</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Activation</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;relu&#39;</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Dropout</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>dropout</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Dense</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>num_labels</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Activation</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;softmax&#39;</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>summary</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>plot_model</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>to_file</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;mlp-mnist.png&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>show_shapes</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>True</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>start</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;compile&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>compile</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>loss</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;categorical_crossentropy&#39;</span><span style=color:#000;font-weight:700>,</span>
              <span style=color:#000>optimizer</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;adam&#39;</span><span style=color:#000;font-weight:700>,</span>
              <span style=color:#000>metrics</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;accuracy&#39;</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>stop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;compile&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>start</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;train&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>fit</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_train</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_train</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>epochs</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>batch_size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>batch_size</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>stop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;train&#34;</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>start</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;test&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>loss</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>acc</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>evaluate</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>batch_size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>batch_size</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#204a87;font-weight:700>print</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>Test accuracy: </span><span style=color:#4e9a06>%.1f%%</span><span style=color:#4e9a06>&#34;</span> <span style=color:#ce5c00;font-weight:700>%</span> <span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>100.0</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>acc</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>stop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;test&#34;</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>benchmark</span><span style=color:#000;font-weight:700>()</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz
11493376/11490434 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 0s 0us/step
Model: <span style=color:#4e9a06>&#34;sequential&#34;</span>
_________________________________________________________________
Layer <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87>type</span><span style=color:#ce5c00;font-weight:700>)</span>                 Output Shape              Param <span style=color:#8f5902;font-style:italic>#   </span>
<span style=color:#ce5c00;font-weight:700>=================================================================</span>
dense <span style=color:#ce5c00;font-weight:700>(</span>Dense<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#ce5c00;font-weight:700>(</span>None, 512<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>401920</span>    
_________________________________________________________________
activation <span style=color:#ce5c00;font-weight:700>(</span>Activation<span style=color:#ce5c00;font-weight:700>)</span>      <span style=color:#ce5c00;font-weight:700>(</span>None, 512<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
dropout <span style=color:#ce5c00;font-weight:700>(</span>Dropout<span style=color:#ce5c00;font-weight:700>)</span>            <span style=color:#ce5c00;font-weight:700>(</span>None, 512<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
dense_1 <span style=color:#ce5c00;font-weight:700>(</span>Dense<span style=color:#ce5c00;font-weight:700>)</span>              <span style=color:#ce5c00;font-weight:700>(</span>None, 512<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>262656</span>    
_________________________________________________________________
activation_1 <span style=color:#ce5c00;font-weight:700>(</span>Activation<span style=color:#ce5c00;font-weight:700>)</span>    <span style=color:#ce5c00;font-weight:700>(</span>None, 512<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
dropout_1 <span style=color:#ce5c00;font-weight:700>(</span>Dropout<span style=color:#ce5c00;font-weight:700>)</span>          <span style=color:#ce5c00;font-weight:700>(</span>None, 512<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
dense_2 <span style=color:#ce5c00;font-weight:700>(</span>Dense<span style=color:#ce5c00;font-weight:700>)</span>              <span style=color:#ce5c00;font-weight:700>(</span>None, 512<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>262656</span>    
_________________________________________________________________
activation_2 <span style=color:#ce5c00;font-weight:700>(</span>Activation<span style=color:#ce5c00;font-weight:700>)</span>    <span style=color:#ce5c00;font-weight:700>(</span>None, 512<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
dropout_2 <span style=color:#ce5c00;font-weight:700>(</span>Dropout<span style=color:#ce5c00;font-weight:700>)</span>          <span style=color:#ce5c00;font-weight:700>(</span>None, 512<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
dense_3 <span style=color:#ce5c00;font-weight:700>(</span>Dense<span style=color:#ce5c00;font-weight:700>)</span>              <span style=color:#ce5c00;font-weight:700>(</span>None, 512<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>262656</span>    
_________________________________________________________________
activation_3 <span style=color:#ce5c00;font-weight:700>(</span>Activation<span style=color:#ce5c00;font-weight:700>)</span>    <span style=color:#ce5c00;font-weight:700>(</span>None, 512<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
dropout_3 <span style=color:#ce5c00;font-weight:700>(</span>Dropout<span style=color:#ce5c00;font-weight:700>)</span>          <span style=color:#ce5c00;font-weight:700>(</span>None, 512<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>0</span>         
_________________________________________________________________
dense_4 <span style=color:#ce5c00;font-weight:700>(</span>Dense<span style=color:#ce5c00;font-weight:700>)</span>              <span style=color:#ce5c00;font-weight:700>(</span>None, 10<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#0000cf;font-weight:700>5130</span>      
_________________________________________________________________
activation_4 <span style=color:#ce5c00;font-weight:700>(</span>Activation<span style=color:#ce5c00;font-weight:700>)</span>    <span style=color:#ce5c00;font-weight:700>(</span>None, 10<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#000>0</span>         
<span style=color:#ce5c00;font-weight:700>=================================================================</span>
Total params: 1,195,018
Trainable params: 1,195,018
Non-trainable params: <span style=color:#0000cf;font-weight:700>0</span>
_________________________________________________________________
Epoch 1/5
469/469 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 14s 29ms/step - loss: 0.7886 - accuracy: 0.7334
Epoch 2/5
469/469 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 14s 29ms/step - loss: 0.1981 - accuracy: 0.9433
Epoch 3/5
469/469 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 14s 29ms/step - loss: 0.1546 - accuracy: 0.9572
Epoch 4/5
469/469 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 14s 29ms/step - loss: 0.1302 - accuracy: 0.9641
Epoch 5/5
469/469 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 14s 29ms/step - loss: 0.1168 - accuracy: 0.9663
79/79 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 1s 9ms/step - loss: 0.0785 - accuracy: 0.9765

Test accuracy: 97.6%

+---------------------+------------------------------------------------------------------+
<span style=color:#000;font-weight:700>|</span> Attribute           <span style=color:#000;font-weight:700>|</span> Value                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span>---------------------+------------------------------------------------------------------<span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> BUG_REPORT_URL      <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;https://bugs.launchpad.net/ubuntu/&#34;</span>                             <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> DISTRIB_CODENAME    <span style=color:#000;font-weight:700>|</span> bionic                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> DISTRIB_DESCRIPTION <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;Ubuntu 18.04.5 LTS&#34;</span>                                             <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> DISTRIB_ID          <span style=color:#000;font-weight:700>|</span> Ubuntu                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> DISTRIB_RELEASE     <span style=color:#000;font-weight:700>|</span> 18.04                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> HOME_URL            <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;https://www.ubuntu.com/&#34;</span>                                        <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> ID                  <span style=color:#000;font-weight:700>|</span> ubuntu                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> ID_LIKE             <span style=color:#000;font-weight:700>|</span> debian                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> NAME                <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;Ubuntu&#34;</span>                                                         <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> PRETTY_NAME         <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;Ubuntu 18.04.5 LTS&#34;</span>                                             <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> PRIVACY_POLICY_URL  <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;https://www.ubuntu.com/legal/terms-and-policies/privacy-policy&#34;</span> <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> SUPPORT_URL         <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;https://help.ubuntu.com/&#34;</span>                                       <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> UBUNTU_CODENAME     <span style=color:#000;font-weight:700>|</span> bionic                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> VERSION             <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;18.04.5 LTS (Bionic Beaver)&#34;</span>                                    <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> VERSION_CODENAME    <span style=color:#000;font-weight:700>|</span> bionic                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> VERSION_ID          <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;18.04&#34;</span>                                                          <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> cpu_count           <span style=color:#000;font-weight:700>|</span> <span style=color:#0000cf;font-weight:700>2</span>                                                                <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.active          <span style=color:#000;font-weight:700>|</span> 1.2 GiB                                                          <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.available       <span style=color:#000;font-weight:700>|</span> 11.6 GiB                                                         <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.free            <span style=color:#000;font-weight:700>|</span> 9.8 GiB                                                          <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.inactive        <span style=color:#000;font-weight:700>|</span> 1.4 GiB                                                          <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.percent         <span style=color:#000;font-weight:700>|</span> 8.4 %                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.total           <span style=color:#000;font-weight:700>|</span> 12.7 GiB                                                         <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.used            <span style=color:#000;font-weight:700>|</span> 913.7 MiB                                                        <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> platform.version    <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020                              |</span>
<span style=color:#000;font-weight:700>|</span> python              <span style=color:#000;font-weight:700>|</span> 3.6.9 <span style=color:#ce5c00;font-weight:700>(</span>default, Oct  <span style=color:#0000cf;font-weight:700>8</span> 2020, 12:12:24<span style=color:#ce5c00;font-weight:700>)</span>                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span>                     <span style=color:#000;font-weight:700>|</span> <span style=color:#ce5c00;font-weight:700>[</span>GCC 8.4.0<span style=color:#ce5c00;font-weight:700>]</span>                                                      <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> python.pip          <span style=color:#000;font-weight:700>|</span> 19.3.1                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> python.version      <span style=color:#000;font-weight:700>|</span> 3.6.9                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> sys.platform        <span style=color:#000;font-weight:700>|</span> linux                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.machine       <span style=color:#000;font-weight:700>|</span> x86_64                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.node          <span style=color:#000;font-weight:700>|</span> 6609095905d1                                                     <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.processor     <span style=color:#000;font-weight:700>|</span> x86_64                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.release       <span style=color:#000;font-weight:700>|</span> 4.19.112+                                                        <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.system        <span style=color:#000;font-weight:700>|</span> Linux                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.version       <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020                              |</span>
<span style=color:#000;font-weight:700>|</span> user                <span style=color:#000;font-weight:700>|</span> collab                                                           <span style=color:#000;font-weight:700>|</span>
+---------------------+------------------------------------------------------------------+

+-----------+----------+--------+--------+---------------------+-------+--------------+--------+-------+-------------------------------------+
<span style=color:#000;font-weight:700>|</span> Name      <span style=color:#000;font-weight:700>|</span> Status   <span style=color:#000;font-weight:700>|</span>   Time <span style=color:#000;font-weight:700>|</span>    Sum <span style=color:#000;font-weight:700>|</span> Start               <span style=color:#000;font-weight:700>|</span> tag   <span style=color:#000;font-weight:700>|</span> Node         <span style=color:#000;font-weight:700>|</span> User   <span style=color:#000;font-weight:700>|</span> OS    <span style=color:#000;font-weight:700>|</span> Version                             <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span>-----------+----------+--------+--------+---------------------+-------+--------------+--------+-------+-------------------------------------<span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> data-load <span style=color:#000;font-weight:700>|</span> failed   <span style=color:#000;font-weight:700>|</span>  0.549 <span style=color:#000;font-weight:700>|</span>  0.549 <span style=color:#000;font-weight:700>|</span> 2021-02-15 15:24:00 <span style=color:#000;font-weight:700>|</span>       <span style=color:#000;font-weight:700>|</span> 6609095905d1 <span style=color:#000;font-weight:700>|</span> collab <span style=color:#000;font-weight:700>|</span> Linux <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020 |</span>
<span style=color:#000;font-weight:700>|</span> compile   <span style=color:#000;font-weight:700>|</span> failed   <span style=color:#000;font-weight:700>|</span>  0.023 <span style=color:#000;font-weight:700>|</span>  0.023 <span style=color:#000;font-weight:700>|</span> 2021-02-15 15:24:01 <span style=color:#000;font-weight:700>|</span>       <span style=color:#000;font-weight:700>|</span> 6609095905d1 <span style=color:#000;font-weight:700>|</span> collab <span style=color:#000;font-weight:700>|</span> Linux <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020 |</span>
<span style=color:#000;font-weight:700>|</span> train     <span style=color:#000;font-weight:700>|</span> failed   <span style=color:#000;font-weight:700>|</span> 69.1   <span style=color:#000;font-weight:700>|</span> 69.1   <span style=color:#000;font-weight:700>|</span> 2021-02-15 15:24:01 <span style=color:#000;font-weight:700>|</span>       <span style=color:#000;font-weight:700>|</span> 6609095905d1 <span style=color:#000;font-weight:700>|</span> collab <span style=color:#000;font-weight:700>|</span> Linux <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020 |</span>
<span style=color:#000;font-weight:700>|</span> <span style=color:#204a87>test</span>      <span style=color:#000;font-weight:700>|</span> failed   <span style=color:#000;font-weight:700>|</span>  0.907 <span style=color:#000;font-weight:700>|</span>  0.907 <span style=color:#000;font-weight:700>|</span> 2021-02-15 15:25:10 <span style=color:#000;font-weight:700>|</span>       <span style=color:#000;font-weight:700>|</span> 6609095905d1 <span style=color:#000;font-weight:700>|</span> collab <span style=color:#000;font-weight:700>|</span> Linux <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020 |</span>
+-----------+----------+--------+--------+---------------------+-------+--------------+--------+-------+-------------------------------------+

<span style=color:#8f5902;font-style:italic># csv,timer,status,time,sum,start,tag,uname.node,user,uname.system,platform.version</span>
<span style=color:#8f5902;font-style:italic># csv,data-load,failed,0.549,0.549,2021-02-15 15:24:00,,6609095905d1,collab,Linux,#1 SMP Thu Jul 23 08:00:38 PDT 2020</span>
<span style=color:#8f5902;font-style:italic># csv,compile,failed,0.023,0.023,2021-02-15 15:24:01,,6609095905d1,collab,Linux,#1 SMP Thu Jul 23 08:00:38 PDT 2020</span>
<span style=color:#8f5902;font-style:italic># csv,train,failed,69.1,69.1,2021-02-15 15:24:01,,6609095905d1,collab,Linux,#1 SMP Thu Jul 23 08:00:38 PDT 2020</span>
<span style=color:#8f5902;font-style:italic># csv,test,failed,0.907,0.907,2021-02-15 15:25:10,,6609095905d1,collab,Linux,#1 SMP Thu Jul 23 08:00:38 PDT 2020</span>
</code></pre></div><h3 id=reference>Reference:</h3><p><a href=https://github.com/PacktPublishing/Advanced-Deep-Learning-with-Keras>Orignal Source to Source Code</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-3c61cb84662835c62f23f27cdcf1af9f>19 - MNIST-RMM Classification on Google Colab</h1><div class=lead>MNIST with Recurrent Neural Networks: Classification on Google Colab</div><div class=aside><table style=width:100%><tr><td><a href=https://colab.research.google.com/github/cybertraining-dsc/cybertraining-dsc.github.io/blob/master/content/en/modules/notebooks/mnist_rnn.ipynb target=_parent><img src=https://colab.research.google.com/assets/colab-badge.svg alt="Open In Colab"></a></td><td><a href=https://github.com/cybertraining-dsc/cybertraining-dsc.github.io/blob/master/content/en/modules/notebooks/mnist_rnn.ipynb target=_parent><img src=https://www.tensorflow.org/images/GitHub-Mark-32px.png alt> View in Github</a></td><td><a href=https://raw.githubusercontent.com/cybertraining-dsc/cybertraining-dsc.github.io/master/content/en/modules/notebooks/mnist_rnn.ipynb download><img src=https://www.tensorflow.org/images/download_logo_32px.png alt></a> Download Notebook</td></tr></table></div><h2 id=prerequisites>Prerequisites</h2><p>Install the following packages</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#a40000>!</span> <span style=color:#000>pip3</span> <span style=color:#000>install</span> <span style=color:#000>cloudmesh</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>installer</span>
<span style=color:#a40000>!</span> <span style=color:#000>pip3</span> <span style=color:#000>install</span> <span style=color:#000>cloudmesh</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>common</span>
</code></pre></div><h2 id=import-libraries>Import Libraries</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>__future__</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>absolute_import</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>__future__</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>division</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>__future__</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>print_function</span>

<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>numpy</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>np</span>
<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>tensorflow</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>tf</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>tensorflow.keras.models</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>Sequential</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>tensorflow.keras.layers</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>Dense</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Activation</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>SimpleRNN</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>tensorflow.keras.utils</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>to_categorical</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>plot_model</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>tensorflow.keras.datasets</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>mnist</span>
<span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>cloudmesh.common.StopWatch</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>StopWatch</span>
</code></pre></div><h2 id=download-data-and-pre-process>Download Data and Pre-Process</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>start</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;data-load&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000;font-weight:700>(</span><span style=color:#000>x_train</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_train</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_test</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>mnist</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>load_data</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>stop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;data-load&#34;</span><span style=color:#000;font-weight:700>)</span>


<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>start</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;data-pre-process&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>num_labels</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87>len</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>unique</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>y_train</span><span style=color:#000;font-weight:700>))</span>


<span style=color:#000>y_train</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>to_categorical</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>y_train</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>y_test</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>to_categorical</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>y_test</span><span style=color:#000;font-weight:700>)</span>


<span style=color:#000>image_size</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x_train</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>shape</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>]</span>
<span style=color:#000>x_train</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reshape</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_train</span><span style=color:#000;font-weight:700>,[</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#000>x_test</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>np</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>reshape</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>,[</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#000>x_train</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x_train</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>astype</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;float32&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>/</span> <span style=color:#0000cf;font-weight:700>255</span>
<span style=color:#000>x_test</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>x_test</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>astype</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;float32&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>/</span> <span style=color:#0000cf;font-weight:700>255</span>
<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>stop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;data-pre-process&#34;</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#000>input_shape</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>image_size</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>image_size</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>batch_size</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>128</span>
<span style=color:#000>units</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>256</span>
<span style=color:#000>dropout</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0.2</span>
</code></pre></div><h2 id=define-model>Define Model</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>start</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;compile&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>model</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Sequential</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>SimpleRNN</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>units</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>units</span><span style=color:#000;font-weight:700>,</span>
                    <span style=color:#000>dropout</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>dropout</span><span style=color:#000;font-weight:700>,</span>
                    <span style=color:#000>input_shape</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>input_shape</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>return_sequences</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>True</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>SimpleRNN</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>units</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>units</span><span style=color:#000;font-weight:700>,</span>
                    <span style=color:#000>dropout</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>dropout</span><span style=color:#000;font-weight:700>,</span>
                    <span style=color:#000>return_sequences</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>True</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>SimpleRNN</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>units</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>units</span><span style=color:#000;font-weight:700>,</span>
                    <span style=color:#000>dropout</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>dropout</span><span style=color:#000;font-weight:700>,</span>
                    <span style=color:#000>return_sequences</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>False</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Dense</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>num_labels</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Activation</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;softmax&#39;</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>summary</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>plot_model</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>model</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>to_file</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;rnn-mnist.png&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>show_shapes</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#3465a4>True</span><span style=color:#000;font-weight:700>)</span>


<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>compile</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>loss</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;categorical_crossentropy&#39;</span><span style=color:#000;font-weight:700>,</span>
              <span style=color:#000>optimizer</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;sgd&#39;</span><span style=color:#000;font-weight:700>,</span>
              <span style=color:#000>metrics</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;accuracy&#39;</span><span style=color:#000;font-weight:700>])</span>
<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>stop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;compile&#34;</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>Model: <span style=color:#4e9a06>&#34;sequential&#34;</span>
_________________________________________________________________
Layer <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87>type</span><span style=color:#ce5c00;font-weight:700>)</span>                 Output Shape              Param <span style=color:#8f5902;font-style:italic>#   </span>
<span style=color:#ce5c00;font-weight:700>=================================================================</span>
simple_rnn <span style=color:#ce5c00;font-weight:700>(</span>SimpleRNN<span style=color:#ce5c00;font-weight:700>)</span>       <span style=color:#ce5c00;font-weight:700>(</span>None, 28, 256<span style=color:#ce5c00;font-weight:700>)</span>           <span style=color:#0000cf;font-weight:700>72960</span>     
_________________________________________________________________
simple_rnn_1 <span style=color:#ce5c00;font-weight:700>(</span>SimpleRNN<span style=color:#ce5c00;font-weight:700>)</span>     <span style=color:#ce5c00;font-weight:700>(</span>None, 28, 256<span style=color:#ce5c00;font-weight:700>)</span>           <span style=color:#0000cf;font-weight:700>131328</span>    
_________________________________________________________________
simple_rnn_2 <span style=color:#ce5c00;font-weight:700>(</span>SimpleRNN<span style=color:#ce5c00;font-weight:700>)</span>     <span style=color:#ce5c00;font-weight:700>(</span>None, 256<span style=color:#ce5c00;font-weight:700>)</span>               <span style=color:#0000cf;font-weight:700>131328</span>    
_________________________________________________________________
dense <span style=color:#ce5c00;font-weight:700>(</span>Dense<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#ce5c00;font-weight:700>(</span>None, 10<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#0000cf;font-weight:700>2570</span>      
_________________________________________________________________
activation <span style=color:#ce5c00;font-weight:700>(</span>Activation<span style=color:#ce5c00;font-weight:700>)</span>      <span style=color:#ce5c00;font-weight:700>(</span>None, 10<span style=color:#ce5c00;font-weight:700>)</span>                <span style=color:#000>0</span>         
<span style=color:#ce5c00;font-weight:700>=================================================================</span>
Total params: 338,186
Trainable params: 338,186
Non-trainable params: <span style=color:#0000cf;font-weight:700>0</span>
</code></pre></div><h2 id=train>Train</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>start</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;train&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>fit</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_train</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_train</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>epochs</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>batch_size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>batch_size</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>stop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;train&#34;</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>469/469 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 125s 266ms/step - loss: 0.6794 - accuracy: 0.7783

&lt;tensorflow.python.keras.callbacks.History at 0x7f35d4b104e0&gt;
</code></pre></div><h2 id=test>Test</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>start</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;evaluate&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>loss</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>acc</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>evaluate</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y_test</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>batch_size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>batch_size</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#204a87;font-weight:700>print</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>Test accuracy: </span><span style=color:#4e9a06>%.1f%%</span><span style=color:#4e9a06>&#34;</span> <span style=color:#ce5c00;font-weight:700>%</span> <span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>100.0</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>acc</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>stop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;evaluate&#34;</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#000>StopWatch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>benchmark</span><span style=color:#000;font-weight:700>()</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>79/79 <span style=color:#ce5c00;font-weight:700>[==============================]</span> - 7s 80ms/step - loss: 0.2581 - accuracy: 0.9181

Test accuracy: 91.8%

+---------------------+------------------------------------------------------------------+
<span style=color:#000;font-weight:700>|</span> Attribute           <span style=color:#000;font-weight:700>|</span> Value                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span>---------------------+------------------------------------------------------------------<span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> BUG_REPORT_URL      <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;https://bugs.launchpad.net/ubuntu/&#34;</span>                             <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> DISTRIB_CODENAME    <span style=color:#000;font-weight:700>|</span> bionic                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> DISTRIB_DESCRIPTION <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;Ubuntu 18.04.5 LTS&#34;</span>                                             <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> DISTRIB_ID          <span style=color:#000;font-weight:700>|</span> Ubuntu                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> DISTRIB_RELEASE     <span style=color:#000;font-weight:700>|</span> 18.04                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> HOME_URL            <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;https://www.ubuntu.com/&#34;</span>                                        <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> ID                  <span style=color:#000;font-weight:700>|</span> ubuntu                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> ID_LIKE             <span style=color:#000;font-weight:700>|</span> debian                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> NAME                <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;Ubuntu&#34;</span>                                                         <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> PRETTY_NAME         <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;Ubuntu 18.04.5 LTS&#34;</span>                                             <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> PRIVACY_POLICY_URL  <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;https://www.ubuntu.com/legal/terms-and-policies/privacy-policy&#34;</span> <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> SUPPORT_URL         <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;https://help.ubuntu.com/&#34;</span>                                       <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> UBUNTU_CODENAME     <span style=color:#000;font-weight:700>|</span> bionic                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> VERSION             <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;18.04.5 LTS (Bionic Beaver)&#34;</span>                                    <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> VERSION_CODENAME    <span style=color:#000;font-weight:700>|</span> bionic                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> VERSION_ID          <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#34;18.04&#34;</span>                                                          <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> cpu_count           <span style=color:#000;font-weight:700>|</span> <span style=color:#0000cf;font-weight:700>2</span>                                                                <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.active          <span style=color:#000;font-weight:700>|</span> 1.3 GiB                                                          <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.available       <span style=color:#000;font-weight:700>|</span> 11.6 GiB                                                         <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.free            <span style=color:#000;font-weight:700>|</span> 9.7 GiB                                                          <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.inactive        <span style=color:#000;font-weight:700>|</span> 1.5 GiB                                                          <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.percent         <span style=color:#000;font-weight:700>|</span> 8.5 %                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.total           <span style=color:#000;font-weight:700>|</span> 12.7 GiB                                                         <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> mem.used            <span style=color:#000;font-weight:700>|</span> 978.6 MiB                                                        <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> platform.version    <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020                              |</span>
<span style=color:#000;font-weight:700>|</span> python              <span style=color:#000;font-weight:700>|</span> 3.6.9 <span style=color:#ce5c00;font-weight:700>(</span>default, Oct  <span style=color:#0000cf;font-weight:700>8</span> 2020, 12:12:24<span style=color:#ce5c00;font-weight:700>)</span>                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span>                     <span style=color:#000;font-weight:700>|</span> <span style=color:#ce5c00;font-weight:700>[</span>GCC 8.4.0<span style=color:#ce5c00;font-weight:700>]</span>                                                      <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> python.pip          <span style=color:#000;font-weight:700>|</span> 19.3.1                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> python.version      <span style=color:#000;font-weight:700>|</span> 3.6.9                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> sys.platform        <span style=color:#000;font-weight:700>|</span> linux                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.machine       <span style=color:#000;font-weight:700>|</span> x86_64                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.node          <span style=color:#000;font-weight:700>|</span> 8f16b3b1f784                                                     <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.processor     <span style=color:#000;font-weight:700>|</span> x86_64                                                           <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.release       <span style=color:#000;font-weight:700>|</span> 4.19.112+                                                        <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.system        <span style=color:#000;font-weight:700>|</span> Linux                                                            <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> uname.version       <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020                              |</span>
<span style=color:#000;font-weight:700>|</span> user                <span style=color:#000;font-weight:700>|</span> collab                                                           <span style=color:#000;font-weight:700>|</span>
+---------------------+------------------------------------------------------------------+

+------------------+----------+---------+---------+---------------------+-------+--------------+--------+-------+-------------------------------------+
<span style=color:#000;font-weight:700>|</span> Name             <span style=color:#000;font-weight:700>|</span> Status   <span style=color:#000;font-weight:700>|</span>    Time <span style=color:#000;font-weight:700>|</span>     Sum <span style=color:#000;font-weight:700>|</span> Start               <span style=color:#000;font-weight:700>|</span> tag   <span style=color:#000;font-weight:700>|</span> Node         <span style=color:#000;font-weight:700>|</span> User   <span style=color:#000;font-weight:700>|</span> OS    <span style=color:#000;font-weight:700>|</span> Version                             <span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span>------------------+----------+---------+---------+---------------------+-------+--------------+--------+-------+-------------------------------------<span style=color:#000;font-weight:700>|</span>
<span style=color:#000;font-weight:700>|</span> data-load        <span style=color:#000;font-weight:700>|</span> failed   <span style=color:#000;font-weight:700>|</span>   0.36  <span style=color:#000;font-weight:700>|</span>   0.36  <span style=color:#000;font-weight:700>|</span> 2021-02-18 15:16:12 <span style=color:#000;font-weight:700>|</span>       <span style=color:#000;font-weight:700>|</span> 8f16b3b1f784 <span style=color:#000;font-weight:700>|</span> collab <span style=color:#000;font-weight:700>|</span> Linux <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020 |</span>
<span style=color:#000;font-weight:700>|</span> data-pre-process <span style=color:#000;font-weight:700>|</span> failed   <span style=color:#000;font-weight:700>|</span>   0.086 <span style=color:#000;font-weight:700>|</span>   0.086 <span style=color:#000;font-weight:700>|</span> 2021-02-18 15:16:12 <span style=color:#000;font-weight:700>|</span>       <span style=color:#000;font-weight:700>|</span> 8f16b3b1f784 <span style=color:#000;font-weight:700>|</span> collab <span style=color:#000;font-weight:700>|</span> Linux <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020 |</span>
<span style=color:#000;font-weight:700>|</span> compile          <span style=color:#000;font-weight:700>|</span> failed   <span style=color:#000;font-weight:700>|</span>   0.51  <span style=color:#000;font-weight:700>|</span>   0.51  <span style=color:#000;font-weight:700>|</span> 2021-02-18 15:16:12 <span style=color:#000;font-weight:700>|</span>       <span style=color:#000;font-weight:700>|</span> 8f16b3b1f784 <span style=color:#000;font-weight:700>|</span> collab <span style=color:#000;font-weight:700>|</span> Linux <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020 |</span>
<span style=color:#000;font-weight:700>|</span> train            <span style=color:#000;font-weight:700>|</span> failed   <span style=color:#000;font-weight:700>|</span> 126.612 <span style=color:#000;font-weight:700>|</span> 126.612 <span style=color:#000;font-weight:700>|</span> 2021-02-18 15:16:13 <span style=color:#000;font-weight:700>|</span>       <span style=color:#000;font-weight:700>|</span> 8f16b3b1f784 <span style=color:#000;font-weight:700>|</span> collab <span style=color:#000;font-weight:700>|</span> Linux <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020 |</span>
<span style=color:#000;font-weight:700>|</span> evaluate         <span style=color:#000;font-weight:700>|</span> failed   <span style=color:#000;font-weight:700>|</span>   6.798 <span style=color:#000;font-weight:700>|</span>   6.798 <span style=color:#000;font-weight:700>|</span> 2021-02-18 15:18:19 <span style=color:#000;font-weight:700>|</span>       <span style=color:#000;font-weight:700>|</span> 8f16b3b1f784 <span style=color:#000;font-weight:700>|</span> collab <span style=color:#000;font-weight:700>|</span> Linux <span style=color:#000;font-weight:700>|</span> <span style=color:#8f5902;font-style:italic>#1 SMP Thu Jul 23 08:00:38 PDT 2020 |</span>
+------------------+----------+---------+---------+---------------------+-------+--------------+--------+-------+-------------------------------------+

<span style=color:#8f5902;font-style:italic># csv,timer,status,time,sum,start,tag,uname.node,user,uname.system,platform.version</span>
<span style=color:#8f5902;font-style:italic># csv,data-load,failed,0.36,0.36,2021-02-18 15:16:12,,8f16b3b1f784,collab,Linux,#1 SMP Thu Jul 23 08:00:38 PDT 2020</span>
<span style=color:#8f5902;font-style:italic># csv,data-pre-process,failed,0.086,0.086,2021-02-18 15:16:12,,8f16b3b1f784,collab,Linux,#1 SMP Thu Jul 23 08:00:38 PDT 2020</span>
<span style=color:#8f5902;font-style:italic># csv,compile,failed,0.51,0.51,2021-02-18 15:16:12,,8f16b3b1f784,collab,Linux,#1 SMP Thu Jul 23 08:00:38 PDT 2020</span>
<span style=color:#8f5902;font-style:italic># csv,train,failed,126.612,126.612,2021-02-18 15:16:13,,8f16b3b1f784,collab,Linux,#1 SMP Thu Jul 23 08:00:38 PDT 2020</span>
<span style=color:#8f5902;font-style:italic># csv,evaluate,failed,6.798,6.798,2021-02-18 15:18:19,,8f16b3b1f784,collab,Linux,#1 SMP Thu Jul 23 08:00:38 PDT 2020</span>


</code></pre></div><h3 id=reference>Reference:</h3><p><a href=https://github.com/PacktPublishing/Advanced-Deep-Learning-with-Keras>Orignal Source to Source Code</a></p></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Gregor von Laszewski" aria-label="Gregor von Laszewski"><a class=text-white target=_blank rel=noopener href=https://laszewski.github.io aria-label="Gregor von Laszewski"><i class="fa fa-envelope"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/cybertraining-dsc/cybertraining-dsc.github.io/ aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2021 Indiana University, 2020 All Rights Reserved</small><p class=mt-2><a href=/about/>About Cybertraining</a></p></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/mermaid@8.9.2/dist/mermaid.min.js integrity=sha384-uQikAXnCAqsMb3ygtdqBYvcwvHUkzGIpjdGyy9owhURXHUxLC5LgTcSxJQH/RzjK crossorigin=anonymous></script><script src=/js/deflate.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/katex.min.css integrity=sha384-Cqd8ihRLum0CCg8rz0hYKPoLZ3uw+gES2rXQXycqnL5pgVQIflxAUDS7ZSjITLb5 crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/katex.min.js integrity=sha384-1Or6BdeNQb0ezrmtGeqQHFpppNd7a/gw29xeiSikBbsb44xu3uAo8c7FwbF5jhbd crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/contrib/mhchem.min.js integrity=sha384-LIgAiYlGSAdpNC9+YDjDPF6JeS/RRIumtNo0CmyQERZ/+g0h9MbuYQwf/5pQ4Y4M crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous onload=renderMathInElement(document.body,null);></script><script src=/js/main.min.24fdf50398b189e91e0fc406ea4341e93f56846c34eecd790e12aab363ef5e3c.js integrity="sha256-JP31A5ixiekeD8QG6kNB6T9WhGw07s15DhKqs2PvXjw=" crossorigin=anonymous></script></body></html>